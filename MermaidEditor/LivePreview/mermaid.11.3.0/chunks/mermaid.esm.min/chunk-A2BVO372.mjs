import{a as tt,b as at}from"./chunk-U6LOUQAF.mjs";import{c as rt,d as z}from"./chunk-3SVD6B67.mjs";import{m as Y,o as U}from"./chunk-JCRXNOLL.mjs";import{Ca as K,F as q,G as H,Ga as P,X as k,b as x,fa as v}from"./chunk-XP6OA2RL.mjs";import{a as h}from"./chunk-GTKDMUJJ.mjs";var bt=h((s,t,a,n)=>{t.forEach(l=>{Ct[l](s,a,n)})},"insertMarkers"),wt=h((s,t,a)=>{x.trace("Making markers for ",a),s.append("defs").append("marker").attr("id",a+"_"+t+"-extensionStart").attr("class","marker extension "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 1,7 L18,13 V 1 Z"),s.append("defs").append("marker").attr("id",a+"_"+t+"-extensionEnd").attr("class","marker extension "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 1,1 V 13 L18,7 Z")},"extension"),kt=h((s,t,a)=>{s.append("defs").append("marker").attr("id",a+"_"+t+"-compositionStart").attr("class","marker composition "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),s.append("defs").append("marker").attr("id",a+"_"+t+"-compositionEnd").attr("class","marker composition "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z")},"composition"),Lt=h((s,t,a)=>{s.append("defs").append("marker").attr("id",a+"_"+t+"-aggregationStart").attr("class","marker aggregation "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),s.append("defs").append("marker").attr("id",a+"_"+t+"-aggregationEnd").attr("class","marker aggregation "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z")},"aggregation"),vt=h((s,t,a)=>{s.append("defs").append("marker").attr("id",a+"_"+t+"-dependencyStart").attr("class","marker dependency "+t).attr("refX",6).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 5,7 L9,13 L1,7 L9,1 Z"),s.append("defs").append("marker").attr("id",a+"_"+t+"-dependencyEnd").attr("class","marker dependency "+t).attr("refX",13).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L14,7 L9,1 Z")},"dependency"),St=h((s,t,a)=>{s.append("defs").append("marker").attr("id",a+"_"+t+"-lollipopStart").attr("class","marker lollipop "+t).attr("refX",13).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("circle").attr("stroke","black").attr("fill","transparent").attr("cx",7).attr("cy",7).attr("r",6),s.append("defs").append("marker").attr("id",a+"_"+t+"-lollipopEnd").attr("class","marker lollipop "+t).attr("refX",1).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("circle").attr("stroke","black").attr("fill","transparent").attr("cx",7).attr("cy",7).attr("r",6)},"lollipop"),Bt=h((s,t,a)=>{s.append("marker").attr("id",a+"_"+t+"-pointEnd").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",6).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",12).attr("markerHeight",12).attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0"),s.append("marker").attr("id",a+"_"+t+"-pointStart").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",4.5).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",12).attr("markerHeight",12).attr("orient","auto").append("path").attr("d","M 0 5 L 10 10 L 10 0 z").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0")},"point"),Et=h((s,t,a)=>{s.append("marker").attr("id",a+"_"+t+"-circleEnd").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",11).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("circle").attr("cx","5").attr("cy","5").attr("r","5").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0"),s.append("marker").attr("id",a+"_"+t+"-circleStart").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",-1).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("circle").attr("cx","5").attr("cy","5").attr("r","5").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0")},"circle"),Mt=h((s,t,a)=>{s.append("marker").attr("id",a+"_"+t+"-crossEnd").attr("class","marker cross "+t).attr("viewBox","0 0 11 11").attr("refX",12).attr("refY",5.2).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("path").attr("d","M 1,1 l 9,9 M 10,1 l -9,9").attr("class","arrowMarkerPath").style("stroke-width",2).style("stroke-dasharray","1,0"),s.append("marker").attr("id",a+"_"+t+"-crossStart").attr("class","marker cross "+t).attr("viewBox","0 0 11 11").attr("refX",-1).attr("refY",5.2).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("path").attr("d","M 1,1 l 9,9 M 10,1 l -9,9").attr("class","arrowMarkerPath").style("stroke-width",2).style("stroke-dasharray","1,0")},"cross"),Tt=h((s,t,a)=>{s.append("defs").append("marker").attr("id",a+"_"+t+"-barbEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",14).attr("markerUnits","strokeWidth").attr("orient","auto").append("path").attr("d","M 19,7 L9,13 L14,7 L9,1 Z")},"barb"),Ct={extension:wt,composition:kt,aggregation:Lt,dependency:vt,lollipop:St,point:Bt,circle:Et,cross:Mt,barb:Tt},pr=bt;function et(s,t){t&&s.attr("style",t)}h(et,"applyStyle");function _t(s){let t=v(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")),a=t.append("xhtml:div"),n=s.label,l=s.isNode?"nodeLabel":"edgeLabel",r=a.append("span");return r.html(n),et(r,s.labelStyle),r.attr("class",l),et(a,s.labelStyle),a.style("display","inline-block"),a.style("white-space","nowrap"),a.attr("xmlns","http://www.w3.org/1999/xhtml"),t.node()}h(_t,"addHtmlLabel");var $t=h((s,t,a,n)=>{let l=s||"";if(typeof l=="object"&&(l=l[0]),H(k().flowchart.htmlLabels)){l=l.replace(/\\n|\n/g,"<br />"),x.debug("vertexText"+l);let r={isNode:n,label:rt(U(l)),labelStyle:t.replace("fill:","color:")};return _t(r)}else{let r=document.createElementNS("http://www.w3.org/2000/svg","text");r.setAttribute("style",t.replace("color:","fill:"));let e=[];typeof l=="string"?e=l.split(/\\n|\n|<br\s*\/?>/gi):Array.isArray(l)?e=l:e=[];for(let i of e){let c=document.createElementNS("http://www.w3.org/2000/svg","tspan");c.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),c.setAttribute("dy","1em"),c.setAttribute("x","0"),a?c.setAttribute("class","title-row"):c.setAttribute("class","row"),c.textContent=i.trim(),r.appendChild(c)}return r}},"createLabel"),_=$t;var S=h(async(s,t,a,n)=>{let l=k(),r,e=t.useHtmlLabels||H(l.flowchart.htmlLabels);a?r=a:r="node default";let i=s.insert("g").attr("class",r).attr("id",t.domId||t.id),c=i.insert("g").attr("class","label").attr("style",t.labelStyle),p;t.labelText===void 0?p="":p=typeof t.labelText=="string"?t.labelText:t.labelText[0];let o=c.node(),f;t.labelType==="markdown"?f=z(c,q(U(p),l),{useHtmlLabels:e,width:t.width||l.flowchart.wrappingWidth,classes:"markdown-node-label"},l):f=o.appendChild(_(q(U(p),l),t.labelStyle,!1,n));let y=f.getBBox(),d=t.padding/2;if(H(l.flowchart.htmlLabels)){let u=f.children[0],L=v(f),g=u.getElementsByTagName("img");if(g){let B=p.replace(/<img[^>]*>/g,"").trim()==="";await Promise.all([...g].map(m=>new Promise($=>{function E(){if(m.style.display="flex",m.style.flexDirection="column",B){let W=l.fontSize?l.fontSize:window.getComputedStyle(document.body).fontSize,O=parseInt(W,10)*5+"px";m.style.minWidth=O,m.style.maxWidth=O}else m.style.width="100%";$(m)}h(E,"setupImage"),setTimeout(()=>{m.complete&&E()}),m.addEventListener("error",E),m.addEventListener("load",E)})))}y=u.getBoundingClientRect(),L.attr("width",y.width),L.attr("height",y.height)}return e?c.attr("transform","translate("+-y.width/2+", "+-y.height/2+")"):c.attr("transform","translate(0, "+-y.height/2+")"),t.centerLabel&&c.attr("transform","translate("+-y.width/2+", "+-y.height/2+")"),c.insert("rect",":first-child"),{shapeSvg:i,bbox:y,halfPadding:d,label:c}},"labelHelper"),w=h((s,t)=>{let a=t.node().getBBox();s.width=a.width,s.height=a.height},"updateNodeBounds");function R(s,t,a,n){return s.insert("polygon",":first-child").attr("points",n.map(function(l){return l.x+","+l.y}).join(" ")).attr("class","label-container").attr("transform","translate("+-t/2+","+a/2+")")}h(R,"insertPolygonShape");var Ht=h(s=>{let t=new Set;for(let a of s)switch(a){case"x":t.add("right"),t.add("left");break;case"y":t.add("up"),t.add("down");break;default:t.add(a);break}return t},"expandAndDeduplicateDirections"),st=h((s,t,a)=>{let n=Ht(s),l=2,r=t.height+2*a.padding,e=r/l,i=t.width+2*e+a.padding,c=a.padding/2;return n.has("right")&&n.has("left")&&n.has("up")&&n.has("down")?[{x:0,y:0},{x:e,y:0},{x:i/2,y:2*c},{x:i-e,y:0},{x:i,y:0},{x:i,y:-r/3},{x:i+2*c,y:-r/2},{x:i,y:-2*r/3},{x:i,y:-r},{x:i-e,y:-r},{x:i/2,y:-r-2*c},{x:e,y:-r},{x:0,y:-r},{x:0,y:-2*r/3},{x:-2*c,y:-r/2},{x:0,y:-r/3}]:n.has("right")&&n.has("left")&&n.has("up")?[{x:e,y:0},{x:i-e,y:0},{x:i,y:-r/2},{x:i-e,y:-r},{x:e,y:-r},{x:0,y:-r/2}]:n.has("right")&&n.has("left")&&n.has("down")?[{x:0,y:0},{x:e,y:-r},{x:i-e,y:-r},{x:i,y:0}]:n.has("right")&&n.has("up")&&n.has("down")?[{x:0,y:0},{x:i,y:-e},{x:i,y:-r+e},{x:0,y:-r}]:n.has("left")&&n.has("up")&&n.has("down")?[{x:i,y:0},{x:0,y:-e},{x:0,y:-r+e},{x:i,y:-r}]:n.has("right")&&n.has("left")?[{x:e,y:0},{x:e,y:-c},{x:i-e,y:-c},{x:i-e,y:0},{x:i,y:-r/2},{x:i-e,y:-r},{x:i-e,y:-r+c},{x:e,y:-r+c},{x:e,y:-r},{x:0,y:-r/2}]:n.has("up")&&n.has("down")?[{x:i/2,y:0},{x:0,y:-c},{x:e,y:-c},{x:e,y:-r+c},{x:0,y:-r+c},{x:i/2,y:-r},{x:i,y:-r+c},{x:i-e,y:-r+c},{x:i-e,y:-c},{x:i,y:-c}]:n.has("right")&&n.has("up")?[{x:0,y:0},{x:i,y:-e},{x:0,y:-r}]:n.has("right")&&n.has("down")?[{x:0,y:0},{x:i,y:0},{x:0,y:-r}]:n.has("left")&&n.has("up")?[{x:i,y:0},{x:0,y:-e},{x:i,y:-r}]:n.has("left")&&n.has("down")?[{x:i,y:0},{x:0,y:0},{x:i,y:-r}]:n.has("right")?[{x:e,y:-c},{x:e,y:-c},{x:i-e,y:-c},{x:i-e,y:0},{x:i,y:-r/2},{x:i-e,y:-r},{x:i-e,y:-r+c},{x:e,y:-r+c},{x:e,y:-r+c}]:n.has("left")?[{x:e,y:0},{x:e,y:-c},{x:i-e,y:-c},{x:i-e,y:-r+c},{x:e,y:-r+c},{x:e,y:-r},{x:0,y:-r/2}]:n.has("up")?[{x:e,y:-c},{x:e,y:-r+c},{x:0,y:-r+c},{x:i/2,y:-r},{x:i,y:-r+c},{x:i-e,y:-r+c},{x:i-e,y:-c}]:n.has("down")?[{x:i/2,y:0},{x:0,y:-c},{x:e,y:-c},{x:e,y:-r+c},{x:i-e,y:-r+c},{x:i-e,y:-c},{x:i,y:-c}]:[{x:0,y:0}]},"getArrowPoints");function It(s,t){return s.intersect(t)}h(It,"intersectNode");var it=It;function Nt(s,t,a,n){var l=s.x,r=s.y,e=l-n.x,i=r-n.y,c=Math.sqrt(t*t*i*i+a*a*e*e),p=Math.abs(t*a*e/c);n.x<l&&(p=-p);var o=Math.abs(t*a*i/c);return n.y<r&&(o=-o),{x:l+p,y:r+o}}h(Nt,"intersectEllipse");var Z=Nt;function Rt(s,t,a){return Z(s,t,t,a)}h(Rt,"intersectCircle");var nt=Rt;function Dt(s,t,a,n){var l,r,e,i,c,p,o,f,y,d,u,L,g,B,m;if(l=t.y-s.y,e=s.x-t.x,c=t.x*s.y-s.x*t.y,y=l*a.x+e*a.y+c,d=l*n.x+e*n.y+c,!(y!==0&&d!==0&&lt(y,d))&&(r=n.y-a.y,i=a.x-n.x,p=n.x*a.y-a.x*n.y,o=r*s.x+i*s.y+p,f=r*t.x+i*t.y+p,!(o!==0&&f!==0&&lt(o,f))&&(u=l*i-r*e,u!==0)))return L=Math.abs(u/2),g=e*p-i*c,B=g<0?(g-L)/u:(g+L)/u,g=r*c-l*p,m=g<0?(g-L)/u:(g+L)/u,{x:B,y:m}}h(Dt,"intersectLine");function lt(s,t){return s*t>0}h(lt,"sameSign");var ct=Dt;var ot=Wt;function Wt(s,t,a){var n=s.x,l=s.y,r=[],e=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY;typeof t.forEach=="function"?t.forEach(function(u){e=Math.min(e,u.x),i=Math.min(i,u.y)}):(e=Math.min(e,t.x),i=Math.min(i,t.y));for(var c=n-s.width/2-e,p=l-s.height/2-i,o=0;o<t.length;o++){var f=t[o],y=t[o<t.length-1?o+1:0],d=ct(s,a,{x:c+f.x,y:p+f.y},{x:c+y.x,y:p+y.y});d&&r.push(d)}return r.length?(r.length>1&&r.sort(function(u,L){var g=u.x-a.x,B=u.y-a.y,m=Math.sqrt(g*g+B*B),$=L.x-a.x,E=L.y-a.y,W=Math.sqrt($*$+E*E);return m<W?-1:m===W?0:1}),r[0]):s}h(Wt,"intersectPolygon");var Xt=h((s,t)=>{var a=s.x,n=s.y,l=t.x-a,r=t.y-n,e=s.width/2,i=s.height/2,c,p;return Math.abs(r)*e>Math.abs(l)*i?(r<0&&(i=-i),c=r===0?0:i*l/r,p=i):(l<0&&(e=-e),c=e,p=l===0?0:e*r/l),{x:a+c,y:n+p}},"intersectRect"),ht=Xt;var b={node:it,circle:nt,ellipse:Z,polygon:ot,rect:ht};var Yt=h(async(s,t)=>{t.useHtmlLabels||k().flowchart.htmlLabels||(t.centerLabel=!0);let{shapeSvg:n,bbox:l,halfPadding:r}=await S(s,t,"node "+t.classes,!0);x.info("Classes = ",t.classes);let e=n.insert("rect",":first-child");return e.attr("rx",t.rx).attr("ry",t.ry).attr("x",-l.width/2-r).attr("y",-l.height/2-r).attr("width",l.width+t.padding).attr("height",l.height+t.padding),w(t,e),t.intersect=function(i){return b.rect(t,i)},n},"note"),pt=Yt;var ft=h(s=>s?" "+s:"","formatClass"),N=h((s,t)=>`${t||"node default"}${ft(s.classes)} ${ft(s.class)}`,"getClassesFromNode"),yt=h(async(s,t)=>{let{shapeSvg:a,bbox:n}=await S(s,t,N(t,void 0),!0),l=n.width+t.padding,r=n.height+t.padding,e=l+r,i=[{x:e/2,y:0},{x:e,y:-e/2},{x:e/2,y:-e},{x:0,y:-e/2}];x.info("Question main (Circle)");let c=R(a,e,e,i);return c.attr("style",t.style),w(t,c),t.intersect=function(p){return x.warn("Intersect called"),b.polygon(t,i,p)},a},"question"),At=h((s,t)=>{let a=s.insert("g").attr("class","node default").attr("id",t.domId||t.id),n=28,l=[{x:0,y:n/2},{x:n/2,y:0},{x:0,y:-n/2},{x:-n/2,y:0}];return a.insert("polygon",":first-child").attr("points",l.map(function(e){return e.x+","+e.y}).join(" ")).attr("class","state-start").attr("r",7).attr("width",28).attr("height",28),t.width=28,t.height=28,t.intersect=function(e){return b.circle(t,14,e)},a},"choice"),jt=h(async(s,t)=>{let{shapeSvg:a,bbox:n}=await S(s,t,N(t,void 0),!0),l=4,r=n.height+t.padding,e=r/l,i=n.width+2*e+t.padding,c=[{x:e,y:0},{x:i-e,y:0},{x:i,y:-r/2},{x:i-e,y:-r},{x:e,y:-r},{x:0,y:-r/2}],p=R(a,i,r,c);return p.attr("style",t.style),w(t,p),t.intersect=function(o){return b.polygon(t,c,o)},a},"hexagon"),Ut=h(async(s,t)=>{let{shapeSvg:a,bbox:n}=await S(s,t,void 0,!0),l=2,r=n.height+2*t.padding,e=r/l,i=n.width+2*e+t.padding,c=st(t.directions,n,t),p=R(a,i,r,c);return p.attr("style",t.style),w(t,p),t.intersect=function(o){return b.polygon(t,c,o)},a},"block_arrow"),Ot=h(async(s,t)=>{let{shapeSvg:a,bbox:n}=await S(s,t,N(t,void 0),!0),l=n.width+t.padding,r=n.height+t.padding,e=[{x:-r/2,y:0},{x:l,y:0},{x:l,y:-r},{x:-r/2,y:-r},{x:0,y:-r/2}];return R(a,l,r,e).attr("style",t.style),t.width=l+r,t.height=r,t.intersect=function(c){return b.polygon(t,e,c)},a},"rect_left_inv_arrow"),zt=h(async(s,t)=>{let{shapeSvg:a,bbox:n}=await S(s,t,N(t),!0),l=n.width+t.padding,r=n.height+t.padding,e=[{x:-2*r/6,y:0},{x:l-r/6,y:0},{x:l+2*r/6,y:-r},{x:r/6,y:-r}],i=R(a,l,r,e);return i.attr("style",t.style),w(t,i),t.intersect=function(c){return b.polygon(t,e,c)},a},"lean_right"),Zt=h(async(s,t)=>{let{shapeSvg:a,bbox:n}=await S(s,t,N(t,void 0),!0),l=n.width+t.padding,r=n.height+t.padding,e=[{x:2*r/6,y:0},{x:l+r/6,y:0},{x:l-2*r/6,y:-r},{x:-r/6,y:-r}],i=R(a,l,r,e);return i.attr("style",t.style),w(t,i),t.intersect=function(c){return b.polygon(t,e,c)},a},"lean_left"),Ft=h(async(s,t)=>{let{shapeSvg:a,bbox:n}=await S(s,t,N(t,void 0),!0),l=n.width+t.padding,r=n.height+t.padding,e=[{x:-2*r/6,y:0},{x:l+2*r/6,y:0},{x:l-r/6,y:-r},{x:r/6,y:-r}],i=R(a,l,r,e);return i.attr("style",t.style),w(t,i),t.intersect=function(c){return b.polygon(t,e,c)},a},"trapezoid"),Vt=h(async(s,t)=>{let{shapeSvg:a,bbox:n}=await S(s,t,N(t,void 0),!0),l=n.width+t.padding,r=n.height+t.padding,e=[{x:r/6,y:0},{x:l-r/6,y:0},{x:l+2*r/6,y:-r},{x:-2*r/6,y:-r}],i=R(a,l,r,e);return i.attr("style",t.style),w(t,i),t.intersect=function(c){return b.polygon(t,e,c)},a},"inv_trapezoid"),Gt=h(async(s,t)=>{let{shapeSvg:a,bbox:n}=await S(s,t,N(t,void 0),!0),l=n.width+t.padding,r=n.height+t.padding,e=[{x:0,y:0},{x:l+r/2,y:0},{x:l,y:-r/2},{x:l+r/2,y:-r},{x:0,y:-r}],i=R(a,l,r,e);return i.attr("style",t.style),w(t,i),t.intersect=function(c){return b.polygon(t,e,c)},a},"rect_right_inv_arrow"),Qt=h(async(s,t)=>{let{shapeSvg:a,bbox:n}=await S(s,t,N(t,void 0),!0),l=n.width+t.padding,r=l/2,e=r/(2.5+l/50),i=n.height+e+t.padding,c="M 0,"+e+" a "+r+","+e+" 0,0,0 "+l+" 0 a "+r+","+e+" 0,0,0 "+-l+" 0 l 0,"+i+" a "+r+","+e+" 0,0,0 "+l+" 0 l 0,"+-i,p=a.attr("label-offset-y",e).insert("path",":first-child").attr("style",t.style).attr("d",c).attr("transform","translate("+-l/2+","+-(i/2+e)+")");return w(t,p),t.intersect=function(o){let f=b.rect(t,o),y=f.x-t.x;if(r!=0&&(Math.abs(y)<t.width/2||Math.abs(y)==t.width/2&&Math.abs(f.y-t.y)>t.height/2-e)){let d=e*e*(1-y*y/(r*r));d!=0&&(d=Math.sqrt(d)),d=e-d,o.y-t.y>0&&(d=-d),f.y+=d}return f},a},"cylinder"),qt=h(async(s,t)=>{let{shapeSvg:a,bbox:n,halfPadding:l}=await S(s,t,"node "+t.classes+" "+t.class,!0),r=a.insert("rect",":first-child"),e=t.positioned?t.width:n.width+t.padding,i=t.positioned?t.height:n.height+t.padding,c=t.positioned?-e/2:-n.width/2-l,p=t.positioned?-i/2:-n.height/2-l;if(r.attr("class","basic label-container").attr("style",t.style).attr("rx",t.rx).attr("ry",t.ry).attr("x",c).attr("y",p).attr("width",e).attr("height",i),t.props){let o=new Set(Object.keys(t.props));t.props.borders&&(J(r,t.props.borders,e,i),o.delete("borders")),o.forEach(f=>{x.warn(`Unknown node property ${f}`)})}return w(t,r),t.intersect=function(o){return b.rect(t,o)},a},"rect"),Jt=h(async(s,t)=>{let{shapeSvg:a,bbox:n,halfPadding:l}=await S(s,t,"node "+t.classes,!0),r=a.insert("rect",":first-child"),e=t.positioned?t.width:n.width+t.padding,i=t.positioned?t.height:n.height+t.padding,c=t.positioned?-e/2:-n.width/2-l,p=t.positioned?-i/2:-n.height/2-l;if(r.attr("class","basic cluster composite label-container").attr("style",t.style).attr("rx",t.rx).attr("ry",t.ry).attr("x",c).attr("y",p).attr("width",e).attr("height",i),t.props){let o=new Set(Object.keys(t.props));t.props.borders&&(J(r,t.props.borders,e,i),o.delete("borders")),o.forEach(f=>{x.warn(`Unknown node property ${f}`)})}return w(t,r),t.intersect=function(o){return b.rect(t,o)},a},"composite"),Kt=h(async(s,t)=>{let{shapeSvg:a}=await S(s,t,"label",!0);x.trace("Classes = ",t.class);let n=a.insert("rect",":first-child"),l=0,r=0;if(n.attr("width",l).attr("height",r),a.attr("class","label edgeLabel"),t.props){let e=new Set(Object.keys(t.props));t.props.borders&&(J(n,t.props.borders,l,r),e.delete("borders")),e.forEach(i=>{x.warn(`Unknown node property ${i}`)})}return w(t,n),t.intersect=function(e){return b.rect(t,e)},a},"labelRect");function J(s,t,a,n){let l=[],r=h(i=>{l.push(i,0)},"addBorder"),e=h(i=>{l.push(0,i)},"skipBorder");t.includes("t")?(x.debug("add top border"),r(a)):e(a),t.includes("r")?(x.debug("add right border"),r(n)):e(n),t.includes("b")?(x.debug("add bottom border"),r(a)):e(a),t.includes("l")?(x.debug("add left border"),r(n)):e(n),s.attr("stroke-dasharray",l.join(" "))}h(J,"applyNodePropertyBorders");var Pt=h((s,t)=>{let a;t.classes?a="node "+t.classes:a="node default";let n=s.insert("g").attr("class",a).attr("id",t.domId||t.id),l=n.insert("rect",":first-child"),r=n.insert("line"),e=n.insert("g").attr("class","label"),i=t.labelText.flat?t.labelText.flat():t.labelText,c="";typeof i=="object"?c=i[0]:c=i,x.info("Label text abc79",c,i,typeof i=="object");let p=e.node().appendChild(_(c,t.labelStyle,!0,!0)),o={width:0,height:0};if(H(k().flowchart.htmlLabels)){let L=p.children[0],g=v(p);o=L.getBoundingClientRect(),g.attr("width",o.width),g.attr("height",o.height)}x.info("Text 2",i);let f=i.slice(1,i.length),y=p.getBBox(),d=e.node().appendChild(_(f.join?f.join("<br/>"):f,t.labelStyle,!0,!0));if(H(k().flowchart.htmlLabels)){let L=d.children[0],g=v(d);o=L.getBoundingClientRect(),g.attr("width",o.width),g.attr("height",o.height)}let u=t.padding/2;return v(d).attr("transform","translate( "+(o.width>y.width?0:(y.width-o.width)/2)+", "+(y.height+u+5)+")"),v(p).attr("transform","translate( "+(o.width<y.width?0:-(y.width-o.width)/2)+", 0)"),o=e.node().getBBox(),e.attr("transform","translate("+-o.width/2+", "+(-o.height/2-u+3)+")"),l.attr("class","outer title-state").attr("x",-o.width/2-u).attr("y",-o.height/2-u).attr("width",o.width+t.padding).attr("height",o.height+t.padding),r.attr("class","divider").attr("x1",-o.width/2-u).attr("x2",o.width/2+u).attr("y1",-o.height/2-u+y.height+u).attr("y2",-o.height/2-u+y.height+u),w(t,l),t.intersect=function(L){return b.rect(t,L)},n},"rectWithTitle"),tr=h(async(s,t)=>{let{shapeSvg:a,bbox:n}=await S(s,t,N(t,void 0),!0),l=n.height+t.padding,r=n.width+l/4+t.padding,e=a.insert("rect",":first-child").attr("style",t.style).attr("rx",l/2).attr("ry",l/2).attr("x",-r/2).attr("y",-l/2).attr("width",r).attr("height",l);return w(t,e),t.intersect=function(i){return b.rect(t,i)},a},"stadium"),rr=h(async(s,t)=>{let{shapeSvg:a,bbox:n,halfPadding:l}=await S(s,t,N(t,void 0),!0),r=a.insert("circle",":first-child");return r.attr("style",t.style).attr("rx",t.rx).attr("ry",t.ry).attr("r",n.width/2+l).attr("width",n.width+t.padding).attr("height",n.height+t.padding),x.info("Circle main"),w(t,r),t.intersect=function(e){return x.info("Circle intersect",t,n.width/2+l,e),b.circle(t,n.width/2+l,e)},a},"circle"),ar=h(async(s,t)=>{let{shapeSvg:a,bbox:n,halfPadding:l}=await S(s,t,N(t,void 0),!0),r=5,e=a.insert("g",":first-child"),i=e.insert("circle"),c=e.insert("circle");return e.attr("class",t.class),i.attr("style",t.style).attr("rx",t.rx).attr("ry",t.ry).attr("r",n.width/2+l+r).attr("width",n.width+t.padding+r*2).attr("height",n.height+t.padding+r*2),c.attr("style",t.style).attr("rx",t.rx).attr("ry",t.ry).attr("r",n.width/2+l).attr("width",n.width+t.padding).attr("height",n.height+t.padding),x.info("DoubleCircle main"),w(t,i),t.intersect=function(p){return x.info("DoubleCircle intersect",t,n.width/2+l+r,p),b.circle(t,n.width/2+l+r,p)},a},"doublecircle"),er=h(async(s,t)=>{let{shapeSvg:a,bbox:n}=await S(s,t,N(t,void 0),!0),l=n.width+t.padding,r=n.height+t.padding,e=[{x:0,y:0},{x:l,y:0},{x:l,y:-r},{x:0,y:-r},{x:0,y:0},{x:-8,y:0},{x:l+8,y:0},{x:l+8,y:-r},{x:-8,y:-r},{x:-8,y:0}],i=R(a,l,r,e);return i.attr("style",t.style),w(t,i),t.intersect=function(c){return b.polygon(t,e,c)},a},"subroutine"),sr=h((s,t)=>{let a=s.insert("g").attr("class","node default").attr("id",t.domId||t.id),n=a.insert("circle",":first-child");return n.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14),w(t,n),t.intersect=function(l){return b.circle(t,7,l)},a},"start"),dt=h((s,t,a)=>{let n=s.insert("g").attr("class","node default").attr("id",t.domId||t.id),l=70,r=10;a==="LR"&&(l=10,r=70);let e=n.append("rect").attr("x",-1*l/2).attr("y",-1*r/2).attr("width",l).attr("height",r).attr("class","fork-join");return w(t,e),t.height=t.height+t.padding/2,t.width=t.width+t.padding/2,t.intersect=function(i){return b.rect(t,i)},n},"forkJoin"),ir=h((s,t)=>{let a=s.insert("g").attr("class","node default").attr("id",t.domId||t.id),n=a.insert("circle",":first-child"),l=a.insert("circle",":first-child");return l.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14),n.attr("class","state-end").attr("r",5).attr("width",10).attr("height",10),w(t,l),t.intersect=function(r){return b.circle(t,7,r)},a},"end"),nr=h((s,t)=>{let a=t.padding/2,n=4,l=8,r;t.classes?r="node "+t.classes:r="node default";let e=s.insert("g").attr("class",r).attr("id",t.domId||t.id),i=e.insert("rect",":first-child"),c=e.insert("line"),p=e.insert("line"),o=0,f=n,y=e.insert("g").attr("class","label"),d=0,u=t.classData.annotations?.[0],L=t.classData.annotations[0]?"\xAB"+t.classData.annotations[0]+"\xBB":"",g=y.node().appendChild(_(L,t.labelStyle,!0,!0)),B=g.getBBox();if(H(k().flowchart.htmlLabels)){let M=g.children[0],T=v(g);B=M.getBoundingClientRect(),T.attr("width",B.width),T.attr("height",B.height)}t.classData.annotations[0]&&(f+=B.height+n,o+=B.width);let m=t.classData.label;t.classData.type!==void 0&&t.classData.type!==""&&(k().flowchart.htmlLabels?m+="&lt;"+t.classData.type+"&gt;":m+="<"+t.classData.type+">");let $=y.node().appendChild(_(m,t.labelStyle,!0,!0));v($).attr("class","classTitle");let E=$.getBBox();if(H(k().flowchart.htmlLabels)){let M=$.children[0],T=v($);E=M.getBoundingClientRect(),T.attr("width",E.width),T.attr("height",E.height)}f+=E.height+n,E.width>o&&(o=E.width);let W=[];t.classData.members.forEach(M=>{let T=M.getDisplayDetails(),X=T.displayText;k().flowchart.htmlLabels&&(X=X.replace(/</g,"&lt;").replace(/>/g,"&gt;"));let D=y.node().appendChild(_(X,T.cssStyle?T.cssStyle:t.labelStyle,!0,!0)),I=D.getBBox();if(H(k().flowchart.htmlLabels)){let Q=D.children[0],j=v(D);I=Q.getBoundingClientRect(),j.attr("width",I.width),j.attr("height",I.height)}I.width>o&&(o=I.width),f+=I.height+n,W.push(D)}),f+=l;let G=[];if(t.classData.methods.forEach(M=>{let T=M.getDisplayDetails(),X=T.displayText;k().flowchart.htmlLabels&&(X=X.replace(/</g,"&lt;").replace(/>/g,"&gt;"));let D=y.node().appendChild(_(X,T.cssStyle?T.cssStyle:t.labelStyle,!0,!0)),I=D.getBBox();if(H(k().flowchart.htmlLabels)){let Q=D.children[0],j=v(D);I=Q.getBoundingClientRect(),j.attr("width",I.width),j.attr("height",I.height)}I.width>o&&(o=I.width),f+=I.height+n,G.push(D)}),f+=l,u){let M=(o-B.width)/2;v(g).attr("transform","translate( "+(-1*o/2+M)+", "+-1*f/2+")"),d=B.height+n}let O=(o-E.width)/2;return v($).attr("transform","translate( "+(-1*o/2+O)+", "+(-1*f/2+d)+")"),d+=E.height+n,c.attr("class","divider").attr("x1",-o/2-a).attr("x2",o/2+a).attr("y1",-f/2-a+l+d).attr("y2",-f/2-a+l+d),d+=l,W.forEach(M=>{v(M).attr("transform","translate( "+-o/2+", "+(-1*f/2+d+l/2)+")");let T=M?.getBBox();d+=(T?.height??0)+n}),d+=l,p.attr("class","divider").attr("x1",-o/2-a).attr("x2",o/2+a).attr("y1",-f/2-a+l+d).attr("y2",-f/2-a+l+d),d+=l,G.forEach(M=>{v(M).attr("transform","translate( "+-o/2+", "+(-1*f/2+d)+")");let T=M?.getBBox();d+=(T?.height??0)+n}),i.attr("style",t.style).attr("class","outer title-state").attr("x",-o/2-a).attr("y",-(f/2)-a).attr("width",o+t.padding).attr("height",f+t.padding),w(t,i),t.intersect=function(M){return b.rect(t,M)},e},"class_box"),xt={rhombus:yt,composite:Jt,question:yt,rect:qt,labelRect:Kt,rectWithTitle:Pt,choice:At,circle:rr,doublecircle:ar,stadium:tr,hexagon:jt,block_arrow:Ut,rect_left_inv_arrow:Ot,lean_right:zt,lean_left:Zt,trapezoid:Ft,inv_trapezoid:Vt,rect_right_inv_arrow:Gt,cylinder:Qt,start:sr,end:ir,note:pt,subroutine:er,fork:dt,join:dt,class_box:nr},A={},ya=h(async(s,t,a)=>{let n,l;if(t.link){let r;k().securityLevel==="sandbox"?r="_top":t.linkTarget&&(r=t.linkTarget||"_blank"),n=s.insert("svg:a").attr("xlink:href",t.link).attr("target",r),l=await xt[t.shape](n,t,a)}else l=await xt[t.shape](s,t,a),n=l;return t.tooltip&&l.attr("title",t.tooltip),t.class&&l.attr("class","node default "+t.class),A[t.id]=n,t.haveCallback&&A[t.id].attr("class",A[t.id].attr("class")+" clickable"),n},"insertNode"),da=h((s,t)=>{A[t.id]=s},"setNodeElem"),xa=h(()=>{A={}},"clear"),ga=h(s=>{let t=A[s.id];x.trace("Transforming node",s.diff,s,"translate("+(s.x-s.width/2-5)+", "+s.width/2+")");let a=8,n=s.diff||0;return s.clusterNode?t.attr("transform","translate("+(s.x+n-s.width/2)+", "+(s.y-s.height/2-a)+")"):t.attr("transform","translate("+s.x+", "+s.y+")"),n},"positionNode");var ut=h((s,t,a,n,l)=>{t.arrowTypeStart&&gt(s,"start",t.arrowTypeStart,a,n,l),t.arrowTypeEnd&&gt(s,"end",t.arrowTypeEnd,a,n,l)},"addEdgeMarkers"),lr={arrow_cross:"cross",arrow_point:"point",arrow_barb:"barb",arrow_circle:"circle",aggregation:"aggregation",extension:"extension",composition:"composition",dependency:"dependency",lollipop:"lollipop"},gt=h((s,t,a,n,l,r)=>{let e=lr[a];if(!e){x.warn(`Unknown arrow type: ${a}`);return}let i=t==="start"?"Start":"End";s.attr(`marker-${t}`,`url(${n}#${l}_${r}-${e}${i})`)},"addEdgeMarker");var V={},C={},Ha=h(()=>{V={},C={}},"clear"),Ia=h((s,t)=>{let a=k(),n=H(a.flowchart.htmlLabels),l=t.labelType==="markdown"?z(s,t.label,{style:t.labelStyle,useHtmlLabels:n,addSvgBackground:!0},a):_(t.label,t.labelStyle),r=s.insert("g").attr("class","edgeLabel"),e=r.insert("g").attr("class","label");e.node().appendChild(l);let i=l.getBBox();if(n){let p=l.children[0],o=v(l);i=p.getBoundingClientRect(),o.attr("width",i.width),o.attr("height",i.height)}e.attr("transform","translate("+-i.width/2+", "+-i.height/2+")"),V[t.id]=r,t.width=i.width,t.height=i.height;let c;if(t.startLabelLeft){let p=_(t.startLabelLeft,t.labelStyle),o=s.insert("g").attr("class","edgeTerminals"),f=o.insert("g").attr("class","inner");c=f.node().appendChild(p);let y=p.getBBox();f.attr("transform","translate("+-y.width/2+", "+-y.height/2+")"),C[t.id]||(C[t.id]={}),C[t.id].startLeft=o,F(c,t.startLabelLeft)}if(t.startLabelRight){let p=_(t.startLabelRight,t.labelStyle),o=s.insert("g").attr("class","edgeTerminals"),f=o.insert("g").attr("class","inner");c=o.node().appendChild(p),f.node().appendChild(p);let y=p.getBBox();f.attr("transform","translate("+-y.width/2+", "+-y.height/2+")"),C[t.id]||(C[t.id]={}),C[t.id].startRight=o,F(c,t.startLabelRight)}if(t.endLabelLeft){let p=_(t.endLabelLeft,t.labelStyle),o=s.insert("g").attr("class","edgeTerminals"),f=o.insert("g").attr("class","inner");c=f.node().appendChild(p);let y=p.getBBox();f.attr("transform","translate("+-y.width/2+", "+-y.height/2+")"),o.node().appendChild(p),C[t.id]||(C[t.id]={}),C[t.id].endLeft=o,F(c,t.endLabelLeft)}if(t.endLabelRight){let p=_(t.endLabelRight,t.labelStyle),o=s.insert("g").attr("class","edgeTerminals"),f=o.insert("g").attr("class","inner");c=f.node().appendChild(p);let y=p.getBBox();f.attr("transform","translate("+-y.width/2+", "+-y.height/2+")"),o.node().appendChild(p),C[t.id]||(C[t.id]={}),C[t.id].endRight=o,F(c,t.endLabelRight)}return l},"insertEdgeLabel");function F(s,t){k().flowchart.htmlLabels&&s&&(s.style.width=t.length*9+"px",s.style.height="12px")}h(F,"setTerminalWidth");var Na=h((s,t)=>{x.debug("Moving label abc88 ",s.id,s.label,V[s.id],t);let a=t.updatedPath?t.updatedPath:t.originalPath,n=k(),{subGraphTitleTotalMargin:l}=tt(n);if(s.label){let r=V[s.id],e=s.x,i=s.y;if(a){let c=Y.calcLabelPosition(a);x.debug("Moving label "+s.label+" from (",e,",",i,") to (",c.x,",",c.y,") abc88"),t.updatedPath&&(e=c.x,i=c.y)}r.attr("transform",`translate(${e}, ${i+l/2})`)}if(s.startLabelLeft){let r=C[s.id].startLeft,e=s.x,i=s.y;if(a){let c=Y.calcTerminalLabelPosition(s.arrowTypeStart?10:0,"start_left",a);e=c.x,i=c.y}r.attr("transform",`translate(${e}, ${i})`)}if(s.startLabelRight){let r=C[s.id].startRight,e=s.x,i=s.y;if(a){let c=Y.calcTerminalLabelPosition(s.arrowTypeStart?10:0,"start_right",a);e=c.x,i=c.y}r.attr("transform",`translate(${e}, ${i})`)}if(s.endLabelLeft){let r=C[s.id].endLeft,e=s.x,i=s.y;if(a){let c=Y.calcTerminalLabelPosition(s.arrowTypeEnd?10:0,"end_left",a);e=c.x,i=c.y}r.attr("transform",`translate(${e}, ${i})`)}if(s.endLabelRight){let r=C[s.id].endRight,e=s.x,i=s.y;if(a){let c=Y.calcTerminalLabelPosition(s.arrowTypeEnd?10:0,"end_right",a);e=c.x,i=c.y}r.attr("transform",`translate(${e}, ${i})`)}},"positionEdgeLabel"),cr=h((s,t)=>{let a=s.x,n=s.y,l=Math.abs(t.x-a),r=Math.abs(t.y-n),e=s.width/2,i=s.height/2;return l>=e||r>=i},"outsideNode"),or=h((s,t,a)=>{x.debug(`intersection calc abc89:
  outsidePoint: ${JSON.stringify(t)}
  insidePoint : ${JSON.stringify(a)}
  node        : x:${s.x} y:${s.y} w:${s.width} h:${s.height}`);let n=s.x,l=s.y,r=Math.abs(n-a.x),e=s.width/2,i=a.x<t.x?e-r:e+r,c=s.height/2,p=Math.abs(t.y-a.y),o=Math.abs(t.x-a.x);if(Math.abs(l-t.y)*e>Math.abs(n-t.x)*c){let f=a.y<t.y?t.y-c-l:l-c-t.y;i=o*f/p;let y={x:a.x<t.x?a.x+i:a.x-o+i,y:a.y<t.y?a.y+p-f:a.y-p+f};return i===0&&(y.x=t.x,y.y=t.y),o===0&&(y.x=t.x),p===0&&(y.y=t.y),x.debug(`abc89 topp/bott calc, Q ${p}, q ${f}, R ${o}, r ${i}`,y),y}else{a.x<t.x?i=t.x-e-n:i=n-e-t.x;let f=p*i/o,y=a.x<t.x?a.x+o-i:a.x-o+i,d=a.y<t.y?a.y+f:a.y-f;return x.debug(`sides calc abc89, Q ${p}, q ${f}, R ${o}, r ${i}`,{_x:y,_y:d}),i===0&&(y=t.x,d=t.y),o===0&&(y=t.x),p===0&&(d=t.y),{x:y,y:d}}},"intersection"),mt=h((s,t)=>{x.debug("abc88 cutPathAtIntersect",s,t);let a=[],n=s[0],l=!1;return s.forEach(r=>{if(!cr(t,r)&&!l){let e=or(t,n,r),i=!1;a.forEach(c=>{i=i||c.x===e.x&&c.y===e.y}),a.some(c=>c.x===e.x&&c.y===e.y)||a.push(e),l=!0}else n=r,l||a.push(r)}),a},"cutPathAtIntersect"),Ra=h(function(s,t,a,n,l,r,e){let i=a.points;x.debug("abc88 InsertEdge: edge=",a,"e=",t);let c=!1,p=r.node(t.v);var o=r.node(t.w);o?.intersect&&p?.intersect&&(i=i.slice(1,a.points.length-1),i.unshift(p.intersect(i[0])),i.push(o.intersect(i[i.length-1]))),a.toCluster&&(x.debug("to cluster abc88",n[a.toCluster]),i=mt(a.points,n[a.toCluster].node),c=!0),a.fromCluster&&(x.debug("from cluster abc88",n[a.fromCluster]),i=mt(i.reverse(),n[a.fromCluster].node).reverse(),c=!0);let f=i.filter(E=>!Number.isNaN(E.y)),y=P;a.curve&&(l==="graph"||l==="flowchart")&&(y=a.curve);let{x:d,y:u}=at(a),L=K().x(d).y(u).curve(y),g;switch(a.thickness){case"normal":g="edge-thickness-normal";break;case"thick":g="edge-thickness-thick";break;case"invisible":g="edge-thickness-thick";break;default:g=""}switch(a.pattern){case"solid":g+=" edge-pattern-solid";break;case"dotted":g+=" edge-pattern-dotted";break;case"dashed":g+=" edge-pattern-dashed";break}let B=s.append("path").attr("d",L(f)).attr("id",a.id).attr("class"," "+g+(a.classes?" "+a.classes:"")).attr("style",a.style),m="";(k().flowchart.arrowMarkerAbsolute||k().state.arrowMarkerAbsolute)&&(m=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,m=m.replace(/\(/g,"\\("),m=m.replace(/\)/g,"\\)")),ut(B,a,m,e,l);let $={};return c&&($.updatedPath=i),$.originalPath=a.points,$},"insertEdge");export{pr as a,_ as b,w as c,ht as d,ya as e,da as f,xa as g,ga as h,Ha as i,Ia as j,Na as k,Ra as l};
