import{c as ot}from"./chunk-7H6T7AZC.mjs";import{a as Vt,b as Qe}from"./chunk-U6LOUQAF.mjs";import{d as mt}from"./chunk-3SVD6B67.mjs";import{m as ft,o as Ht}from"./chunk-JCRXNOLL.mjs";import{Ca as qe,F as Fe,G as Y,Ga as Ze,I as ze,K as Xe,L as Ye,X as z,b as R,fa as Q}from"./chunk-XP6OA2RL.mjs";import{a as u}from"./chunk-GTKDMUJJ.mjs";function ye(i,t,s){if(i&&i.length){let[a,r]=t,o=Math.PI/180*s,h=Math.cos(o),e=Math.sin(o);for(let l of i){let[n,c]=l;l[0]=(n-a)*h-(c-r)*e+a,l[1]=(n-a)*e+(c-r)*h+r}}}u(ye,"t");function Vr(i,t){return i[0]===t[0]&&i[1]===t[1]}u(Vr,"e");function Wr(i,t,s,a=1){let r=s,o=Math.max(t,.1),h=i[0]&&i[0][0]&&typeof i[0][0]=="number"?[i]:i,e=[0,0];if(r)for(let n of h)ye(n,e,r);let l=function(n,c,p){let f=[];for(let b of n){let w=[...b];Vr(w[0],w[w.length-1])||w.push([w[0][0],w[0][1]]),w.length>2&&f.push(w)}let m=[];c=Math.max(c,.1);let g=[];for(let b of f)for(let w=0;w<b.length-1;w++){let P=b[w],M=b[w+1];if(P[1]!==M[1]){let A=Math.min(P[1],M[1]);g.push({ymin:A,ymax:Math.max(P[1],M[1]),x:A===P[1]?P[0]:M[0],islope:(M[0]-P[0])/(M[1]-P[1])})}}if(g.sort((b,w)=>b.ymin<w.ymin?-1:b.ymin>w.ymin?1:b.x<w.x?-1:b.x>w.x?1:b.ymax===w.ymax?0:(b.ymax-w.ymax)/Math.abs(b.ymax-w.ymax)),!g.length)return m;let d=[],x=g[0].ymin,y=0;for(;d.length||g.length;){if(g.length){let b=-1;for(let w=0;w<g.length&&!(g[w].ymin>x);w++)b=w;g.splice(0,b+1).forEach(w=>{d.push({s:x,edge:w})})}if(d=d.filter(b=>!(b.edge.ymax<=x)),d.sort((b,w)=>b.edge.x===w.edge.x?0:(b.edge.x-w.edge.x)/Math.abs(b.edge.x-w.edge.x)),(p!==1||y%c==0)&&d.length>1)for(let b=0;b<d.length;b+=2){let w=b+1;if(w>=d.length)break;let P=d[b].edge,M=d[w].edge;m.push([[Math.round(P.x),x],[Math.round(M.x),x]])}x+=p,d.forEach(b=>{b.edge.x=b.edge.x+p*b.edge.islope}),y++}return m}(h,o,a);if(r){for(let n of h)ye(n,e,-r);(function(n,c,p){let f=[];n.forEach(m=>f.push(...m)),ye(f,c,p)})(l,e,-r)}return l}u(Wr,"s");function Nt(i,t){var s;let a=t.hachureAngle+90,r=t.hachureGap;r<0&&(r=4*t.strokeWidth),r=Math.round(Math.max(r,.1));let o=1;return t.roughness>=1&&(((s=t.randomizer)===null||s===void 0?void 0:s.next())||Math.random())>.7&&(o=r),Wr(i,r,a,o||1)}u(Nt,"n");var Mt=class{static{u(this,"o")}constructor(t){this.helper=t}fillPolygons(t,s){return this._fillPolygons(t,s)}_fillPolygons(t,s){let a=Nt(t,s);return{type:"fillSketch",ops:this.renderLines(a,s)}}renderLines(t,s){let a=[];for(let r of t)a.push(...this.helper.doubleLineOps(r[0][0],r[0][1],r[1][0],r[1][1],s));return a}};function Yt(i){let t=i[0],s=i[1];return Math.sqrt(Math.pow(t[0]-s[0],2)+Math.pow(t[1]-s[1],2))}u(Yt,"a");var ke=class extends Mt{static{u(this,"h")}fillPolygons(t,s){let a=s.hachureGap;a<0&&(a=4*s.strokeWidth),a=Math.max(a,.1);let r=Nt(t,Object.assign({},s,{hachureGap:a})),o=Math.PI/180*s.hachureAngle,h=[],e=.5*a*Math.cos(o),l=.5*a*Math.sin(o);for(let[n,c]of r)Yt([n,c])&&h.push([[n[0]-e,n[1]+l],[...c]],[[n[0]+e,n[1]-l],[...c]]);return{type:"fillSketch",ops:this.renderLines(h,s)}}},Me=class extends Mt{static{u(this,"r")}fillPolygons(t,s){let a=this._fillPolygons(t,s),r=Object.assign({},s,{hachureAngle:s.hachureAngle+90}),o=this._fillPolygons(t,r);return a.ops=a.ops.concat(o.ops),a}},Ne=class{static{u(this,"i")}constructor(t){this.helper=t}fillPolygons(t,s){let a=Nt(t,s=Object.assign({},s,{hachureAngle:0}));return this.dotsOnLines(a,s)}dotsOnLines(t,s){let a=[],r=s.hachureGap;r<0&&(r=4*s.strokeWidth),r=Math.max(r,.1);let o=s.fillWeight;o<0&&(o=s.strokeWidth/2);let h=r/4;for(let e of t){let l=Yt(e),n=l/r,c=Math.ceil(n)-1,p=l-c*r,f=(e[0][0]+e[1][0])/2-r/4,m=Math.min(e[0][1],e[1][1]);for(let g=0;g<c;g++){let d=m+p+g*r,x=f-h+2*Math.random()*h,y=d-h+2*Math.random()*h,b=this.helper.ellipse(x,y,o,o,s);a.push(...b.ops)}}return{type:"fillSketch",ops:a}}},ve=class{static{u(this,"c")}constructor(t){this.helper=t}fillPolygons(t,s){let a=Nt(t,s);return{type:"fillSketch",ops:this.dashedLine(a,s)}}dashedLine(t,s){let a=s.dashOffset<0?s.hachureGap<0?4*s.strokeWidth:s.hachureGap:s.dashOffset,r=s.dashGap<0?s.hachureGap<0?4*s.strokeWidth:s.hachureGap:s.dashGap,o=[];return t.forEach(h=>{let e=Yt(h),l=Math.floor(e/(a+r)),n=(e+r-l*(a+r))/2,c=h[0],p=h[1];c[0]>p[0]&&(c=h[1],p=h[0]);let f=Math.atan((p[1]-c[1])/(p[0]-c[0]));for(let m=0;m<l;m++){let g=m*(a+r),d=g+a,x=[c[0]+g*Math.cos(f)+n*Math.cos(f),c[1]+g*Math.sin(f)+n*Math.sin(f)],y=[c[0]+d*Math.cos(f)+n*Math.cos(f),c[1]+d*Math.sin(f)+n*Math.sin(f)];o.push(...this.helper.doubleLineOps(x[0],x[1],y[0],y[1],s))}}),o}},$e=class{static{u(this,"l")}constructor(t){this.helper=t}fillPolygons(t,s){let a=s.hachureGap<0?4*s.strokeWidth:s.hachureGap,r=s.zigzagOffset<0?a:s.zigzagOffset,o=Nt(t,s=Object.assign({},s,{hachureGap:a+r}));return{type:"fillSketch",ops:this.zigzagLines(o,r,s)}}zigzagLines(t,s,a){let r=[];return t.forEach(o=>{let h=Yt(o),e=Math.round(h/(2*s)),l=o[0],n=o[1];l[0]>n[0]&&(l=o[1],n=o[0]);let c=Math.atan((n[1]-l[1])/(n[0]-l[0]));for(let p=0;p<e;p++){let f=2*p*s,m=2*(p+1)*s,g=Math.sqrt(2*Math.pow(s,2)),d=[l[0]+f*Math.cos(c),l[1]+f*Math.sin(c)],x=[l[0]+m*Math.cos(c),l[1]+m*Math.sin(c)],y=[d[0]+g*Math.cos(c+Math.PI/4),d[1]+g*Math.sin(c+Math.PI/4)];r.push(...this.helper.doubleLineOps(d[0],d[1],y[0],y[1],a),...this.helper.doubleLineOps(y[0],y[1],x[0],x[1],a))}}),r}},J={},Pe=class{static{u(this,"p")}constructor(t){this.seed=t}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}},Tr=0,xe=1,Ue=2,Wt={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function be(i,t){return i.type===t}u(be,"k");function Be(i){let t=[],s=function(h){let e=new Array;for(;h!=="";)if(h.match(/^([ \t\r\n,]+)/))h=h.substr(RegExp.$1.length);else if(h.match(/^([aAcChHlLmMqQsStTvVzZ])/))e[e.length]={type:Tr,text:RegExp.$1},h=h.substr(RegExp.$1.length);else{if(!h.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];e[e.length]={type:xe,text:`${parseFloat(RegExp.$1)}`},h=h.substr(RegExp.$1.length)}return e[e.length]={type:Ue,text:""},e}(i),a="BOD",r=0,o=s[r];for(;!be(o,Ue);){let h=0,e=[];if(a==="BOD"){if(o.text!=="M"&&o.text!=="m")return Be("M0,0"+i);r++,h=Wt[o.text],a=o.text}else be(o,xe)?h=Wt[a]:(r++,h=Wt[o.text],a=o.text);if(!(r+h<s.length))throw new Error("Path data ended short");for(let l=r;l<r+h;l++){let n=s[l];if(!be(n,xe))throw new Error("Param not a number: "+a+","+n.text);e[e.length]=+n.text}if(typeof Wt[a]!="number")throw new Error("Bad segment: "+a);{let l={key:a,data:e};t.push(l),r+=h,o=s[r],a==="M"&&(a="L"),a==="m"&&(a="l")}}return t}u(Be,"b");function or(i){let t=0,s=0,a=0,r=0,o=[];for(let{key:h,data:e}of i)switch(h){case"M":o.push({key:"M",data:[...e]}),[t,s]=e,[a,r]=e;break;case"m":t+=e[0],s+=e[1],o.push({key:"M",data:[t,s]}),a=t,r=s;break;case"L":o.push({key:"L",data:[...e]}),[t,s]=e;break;case"l":t+=e[0],s+=e[1],o.push({key:"L",data:[t,s]});break;case"C":o.push({key:"C",data:[...e]}),t=e[4],s=e[5];break;case"c":{let l=e.map((n,c)=>c%2?n+s:n+t);o.push({key:"C",data:l}),t=l[4],s=l[5];break}case"Q":o.push({key:"Q",data:[...e]}),t=e[2],s=e[3];break;case"q":{let l=e.map((n,c)=>c%2?n+s:n+t);o.push({key:"Q",data:l}),t=l[2],s=l[3];break}case"A":o.push({key:"A",data:[...e]}),t=e[5],s=e[6];break;case"a":t+=e[5],s+=e[6],o.push({key:"A",data:[e[0],e[1],e[2],e[3],e[4],t,s]});break;case"H":o.push({key:"H",data:[...e]}),t=e[0];break;case"h":t+=e[0],o.push({key:"H",data:[t]});break;case"V":o.push({key:"V",data:[...e]}),s=e[0];break;case"v":s+=e[0],o.push({key:"V",data:[s]});break;case"S":o.push({key:"S",data:[...e]}),t=e[2],s=e[3];break;case"s":{let l=e.map((n,c)=>c%2?n+s:n+t);o.push({key:"S",data:l}),t=l[2],s=l[3];break}case"T":o.push({key:"T",data:[...e]}),t=e[0],s=e[1];break;case"t":t+=e[0],s+=e[1],o.push({key:"T",data:[t,s]});break;case"Z":case"z":o.push({key:"Z",data:[]}),t=a,s=r}return o}u(or,"y");function nr(i){let t=[],s="",a=0,r=0,o=0,h=0,e=0,l=0;for(let{key:n,data:c}of i){switch(n){case"M":t.push({key:"M",data:[...c]}),[a,r]=c,[o,h]=c;break;case"C":t.push({key:"C",data:[...c]}),a=c[4],r=c[5],e=c[2],l=c[3];break;case"L":t.push({key:"L",data:[...c]}),[a,r]=c;break;case"H":a=c[0],t.push({key:"L",data:[a,r]});break;case"V":r=c[0],t.push({key:"L",data:[a,r]});break;case"S":{let p=0,f=0;s==="C"||s==="S"?(p=a+(a-e),f=r+(r-l)):(p=a,f=r),t.push({key:"C",data:[p,f,...c]}),e=c[0],l=c[1],a=c[2],r=c[3];break}case"T":{let[p,f]=c,m=0,g=0;s==="Q"||s==="T"?(m=a+(a-e),g=r+(r-l)):(m=a,g=r);let d=a+2*(m-a)/3,x=r+2*(g-r)/3,y=p+2*(m-p)/3,b=f+2*(g-f)/3;t.push({key:"C",data:[d,x,y,b,p,f]}),e=m,l=g,a=p,r=f;break}case"Q":{let[p,f,m,g]=c,d=a+2*(p-a)/3,x=r+2*(f-r)/3,y=m+2*(p-m)/3,b=g+2*(f-g)/3;t.push({key:"C",data:[d,x,y,b,m,g]}),e=p,l=f,a=m,r=g;break}case"A":{let p=Math.abs(c[0]),f=Math.abs(c[1]),m=c[2],g=c[3],d=c[4],x=c[5],y=c[6];p===0||f===0?(t.push({key:"C",data:[a,r,x,y,x,y]}),a=x,r=y):(a!==x||r!==y)&&(ir(a,r,x,y,p,f,m,g,d).forEach(function(b){t.push({key:"C",data:b})}),a=x,r=y);break}case"Z":t.push({key:"Z",data:[]}),a=o,r=h}s=n}return t}u(nr,"m");function St(i,t,s){return[i*Math.cos(s)-t*Math.sin(s),i*Math.sin(s)+t*Math.cos(s)]}u(St,"w");function ir(i,t,s,a,r,o,h,e,l,n){let c=(p=h,Math.PI*p/180);var p;let f=[],m=0,g=0,d=0,x=0;if(n)[m,g,d,x]=n;else{[i,t]=St(i,t,-c),[s,a]=St(s,a,-c);let G=(i-s)/2,O=(t-a)/2,L=G*G/(r*r)+O*O/(o*o);L>1&&(L=Math.sqrt(L),r*=L,o*=L);let j=r*r,T=o*o,U=j*T-j*O*O-T*G*G,at=j*O*O+T*G*G,_e=(e===l?-1:1)*Math.sqrt(Math.abs(U/at));d=_e*r*O/o+(i+s)/2,x=_e*-o*G/r+(t+a)/2,m=Math.asin(parseFloat(((t-x)/o).toFixed(9))),g=Math.asin(parseFloat(((a-x)/o).toFixed(9))),i<d&&(m=Math.PI-m),s<d&&(g=Math.PI-g),m<0&&(m=2*Math.PI+m),g<0&&(g=2*Math.PI+g),l&&m>g&&(m-=2*Math.PI),!l&&g>m&&(g-=2*Math.PI)}let y=g-m;if(Math.abs(y)>120*Math.PI/180){let G=g,O=s,L=a;g=l&&g>m?m+120*Math.PI/180*1:m+120*Math.PI/180*-1,f=ir(s=d+r*Math.cos(g),a=x+o*Math.sin(g),O,L,r,o,h,0,l,[g,G,d,x])}y=g-m;let b=Math.cos(m),w=Math.sin(m),P=Math.cos(g),M=Math.sin(g),A=Math.tan(y/4),B=4/3*r*A,E=4/3*o*A,W=[i,t],H=[i+B*w,t-E*b],_=[s+B*M,a-E*P],F=[s,a];if(H[0]=2*W[0]-H[0],H[1]=2*W[1]-H[1],n)return[H,_,F].concat(f);{f=[H,_,F].concat(f);let G=[];for(let O=0;O<f.length;O+=3){let L=St(f[O][0],f[O][1],c),j=St(f[O+1][0],f[O+1][1],c),T=St(f[O+2][0],f[O+2][1],c);G.push([L[0],L[1],j[0],j[1],T[0],T[1]])}return G}}u(ir,"x");var jr={randOffset:u(function(i,t){return I(i,t)},"randOffset"),randOffsetWithRange:u(function(i,t,s){return Ft(i,t,s)},"randOffsetWithRange"),ellipse:u(function(i,t,s,a,r){let o=cr(s,a,r);return Ce(i,t,r,o).opset},"ellipse"),doubleLineOps:u(function(i,t,s,a,r){return nt(i,t,s,a,r,!0)},"doubleLineOps")};function lr(i,t,s,a,r){return{type:"path",ops:nt(i,t,s,a,r)}}u(lr,"v");function It(i,t,s){let a=(i||[]).length;if(a>2){let r=[];for(let o=0;o<a-1;o++)r.push(...nt(i[o][0],i[o][1],i[o+1][0],i[o+1][1],s));return t&&r.push(...nt(i[a-1][0],i[a-1][1],i[0][0],i[0][1],s)),{type:"path",ops:r}}return a===2?lr(i[0][0],i[0][1],i[1][0],i[1][1],s):{type:"path",ops:[]}}u(It,"S");function Ir(i,t,s,a,r){return function(o,h){return It(o,!0,h)}([[i,t],[i+s,t],[i+s,t+a],[i,t+a]],r)}u(Ir,"O");function Je(i,t){if(i.length){let s=typeof i[0][0]=="number"?[i]:i,a=Tt(s[0],1*(1+.2*t.roughness),t),r=t.disableMultiStroke?[]:Tt(s[0],1.5*(1+.22*t.roughness),er(t));for(let o=1;o<s.length;o++){let h=s[o];if(h.length){let e=Tt(h,1*(1+.2*t.roughness),t),l=t.disableMultiStroke?[]:Tt(h,1.5*(1+.22*t.roughness),er(t));for(let n of e)n.op!=="move"&&a.push(n);for(let n of l)n.op!=="move"&&r.push(n)}}return{type:"path",ops:a.concat(r)}}return{type:"path",ops:[]}}u(Je,"L");function cr(i,t,s){let a=Math.sqrt(2*Math.PI*Math.sqrt((Math.pow(i/2,2)+Math.pow(t/2,2))/2)),r=Math.ceil(Math.max(s.curveStepCount,s.curveStepCount/Math.sqrt(200)*a)),o=2*Math.PI/r,h=Math.abs(i/2),e=Math.abs(t/2),l=1-s.curveFitting;return h+=I(h*l,s),e+=I(e*l,s),{increment:o,rx:h,ry:e}}u(cr,"T");function Ce(i,t,s,a){let[r,o]=rr(a.increment,i,t,a.rx,a.ry,1,a.increment*Ft(.1,Ft(.4,1,s),s),s),h=zt(r,null,s);if(!s.disableMultiStroke&&s.roughness!==0){let[e]=rr(a.increment,i,t,a.rx,a.ry,1.5,0,s),l=zt(e,null,s);h=h.concat(l)}return{estimatedPoints:o,opset:{type:"path",ops:h}}}u(Ce,"D");function Ke(i,t,s,a,r,o,h,e,l){let n=i,c=t,p=Math.abs(s/2),f=Math.abs(a/2);p+=I(.01*p,l),f+=I(.01*f,l);let m=r,g=o;for(;m<0;)m+=2*Math.PI,g+=2*Math.PI;g-m>2*Math.PI&&(m=0,g=2*Math.PI);let d=2*Math.PI/l.curveStepCount,x=Math.min(d/2,(g-m)/2),y=sr(x,n,c,p,f,m,g,1,l);if(!l.disableMultiStroke){let b=sr(x,n,c,p,f,m,g,1.5,l);y.push(...b)}return h&&(e?y.push(...nt(n,c,n+p*Math.cos(m),c+f*Math.sin(m),l),...nt(n,c,n+p*Math.cos(g),c+f*Math.sin(g),l)):y.push({op:"lineTo",data:[n,c]},{op:"lineTo",data:[n+p*Math.cos(m),c+f*Math.sin(m)]})),{type:"path",ops:y}}u(Ke,"A");function tr(i,t){let s=nr(or(Be(i))),a=[],r=[0,0],o=[0,0];for(let{key:h,data:e}of s)switch(h){case"M":o=[e[0],e[1]],r=[e[0],e[1]];break;case"L":a.push(...nt(o[0],o[1],e[0],e[1],t)),o=[e[0],e[1]];break;case"C":{let[l,n,c,p,f,m]=e;a.push(..._r(l,n,c,p,f,m,o,t)),o=[f,m];break}case"Z":a.push(...nt(o[0],o[1],r[0],r[1],t)),o=[r[0],r[1]]}return{type:"path",ops:a}}u(tr,"_");function we(i,t){let s=[];for(let a of i)if(a.length){let r=t.maxRandomnessOffset||0,o=a.length;if(o>2){s.push({op:"move",data:[a[0][0]+I(r,t),a[0][1]+I(r,t)]});for(let h=1;h<o;h++)s.push({op:"lineTo",data:[a[h][0]+I(r,t),a[h][1]+I(r,t)]})}}return{type:"fillPath",ops:s}}u(we,"I");function gt(i,t){return function(s,a){let r=s.fillStyle||"hachure";if(!J[r])switch(r){case"zigzag":J[r]||(J[r]=new ke(a));break;case"cross-hatch":J[r]||(J[r]=new Me(a));break;case"dots":J[r]||(J[r]=new Ne(a));break;case"dashed":J[r]||(J[r]=new ve(a));break;case"zigzag-line":J[r]||(J[r]=new $e(a));break;default:r="hachure",J[r]||(J[r]=new Mt(a))}return J[r]}(t,jr).fillPolygons(i,t)}u(gt,"C");function er(i){let t=Object.assign({},i);return t.randomizer=void 0,i.seed&&(t.seed=i.seed+1),t}u(er,"z");function hr(i){return i.randomizer||(i.randomizer=new Pe(i.seed||0)),i.randomizer.next()}u(hr,"W");function Ft(i,t,s,a=1){return s.roughness*a*(hr(s)*(t-i)+i)}u(Ft,"E");function I(i,t,s=1){return Ft(-i,i,t,s)}u(I,"G");function nt(i,t,s,a,r,o=!1){let h=o?r.disableMultiStrokeFill:r.disableMultiStroke,e=De(i,t,s,a,r,!0,!1);if(h)return e;let l=De(i,t,s,a,r,!0,!0);return e.concat(l)}u(nt,"$");function De(i,t,s,a,r,o,h){let e=Math.pow(i-s,2)+Math.pow(t-a,2),l=Math.sqrt(e),n=1;n=l<200?1:l>500?.4:-.0016668*l+1.233334;let c=r.maxRandomnessOffset||0;c*c*100>e&&(c=l/10);let p=c/2,f=.2+.2*hr(r),m=r.bowing*r.maxRandomnessOffset*(a-t)/200,g=r.bowing*r.maxRandomnessOffset*(i-s)/200;m=I(m,r,n),g=I(g,r,n);let d=[],x=u(()=>I(p,r,n),"M"),y=u(()=>I(c,r,n),"k"),b=r.preserveVertices;return o&&(h?d.push({op:"move",data:[i+(b?0:x()),t+(b?0:x())]}):d.push({op:"move",data:[i+(b?0:I(c,r,n)),t+(b?0:I(c,r,n))]})),h?d.push({op:"bcurveTo",data:[m+i+(s-i)*f+x(),g+t+(a-t)*f+x(),m+i+2*(s-i)*f+x(),g+t+2*(a-t)*f+x(),s+(b?0:x()),a+(b?0:x())]}):d.push({op:"bcurveTo",data:[m+i+(s-i)*f+y(),g+t+(a-t)*f+y(),m+i+2*(s-i)*f+y(),g+t+2*(a-t)*f+y(),s+(b?0:y()),a+(b?0:y())]}),d}u(De,"R");function Tt(i,t,s){if(!i.length)return[];let a=[];a.push([i[0][0]+I(t,s),i[0][1]+I(t,s)]),a.push([i[0][0]+I(t,s),i[0][1]+I(t,s)]);for(let r=1;r<i.length;r++)a.push([i[r][0]+I(t,s),i[r][1]+I(t,s)]),r===i.length-1&&a.push([i[r][0]+I(t,s),i[r][1]+I(t,s)]);return zt(a,null,s)}u(Tt,"j");function zt(i,t,s){let a=i.length,r=[];if(a>3){let o=[],h=1-s.curveTightness;r.push({op:"move",data:[i[1][0],i[1][1]]});for(let e=1;e+2<a;e++){let l=i[e];o[0]=[l[0],l[1]],o[1]=[l[0]+(h*i[e+1][0]-h*i[e-1][0])/6,l[1]+(h*i[e+1][1]-h*i[e-1][1])/6],o[2]=[i[e+1][0]+(h*i[e][0]-h*i[e+2][0])/6,i[e+1][1]+(h*i[e][1]-h*i[e+2][1])/6],o[3]=[i[e+1][0],i[e+1][1]],r.push({op:"bcurveTo",data:[o[1][0],o[1][1],o[2][0],o[2][1],o[3][0],o[3][1]]})}if(t&&t.length===2){let e=s.maxRandomnessOffset;r.push({op:"lineTo",data:[t[0]+I(e,s),t[1]+I(e,s)]})}}else a===3?(r.push({op:"move",data:[i[1][0],i[1][1]]}),r.push({op:"bcurveTo",data:[i[1][0],i[1][1],i[2][0],i[2][1],i[2][0],i[2][1]]})):a===2&&r.push(...De(i[0][0],i[0][1],i[1][0],i[1][1],s,!0,!0));return r}u(zt,"q");function rr(i,t,s,a,r,o,h,e){let l=[],n=[];if(e.roughness===0){i/=4,n.push([t+a*Math.cos(-i),s+r*Math.sin(-i)]);for(let c=0;c<=2*Math.PI;c+=i){let p=[t+a*Math.cos(c),s+r*Math.sin(c)];l.push(p),n.push(p)}n.push([t+a*Math.cos(0),s+r*Math.sin(0)]),n.push([t+a*Math.cos(i),s+r*Math.sin(i)])}else{let c=I(.5,e)-Math.PI/2;n.push([I(o,e)+t+.9*a*Math.cos(c-i),I(o,e)+s+.9*r*Math.sin(c-i)]);let p=2*Math.PI+c-.01;for(let f=c;f<p;f+=i){let m=[I(o,e)+t+a*Math.cos(f),I(o,e)+s+r*Math.sin(f)];l.push(m),n.push(m)}n.push([I(o,e)+t+a*Math.cos(c+2*Math.PI+.5*h),I(o,e)+s+r*Math.sin(c+2*Math.PI+.5*h)]),n.push([I(o,e)+t+.98*a*Math.cos(c+h),I(o,e)+s+.98*r*Math.sin(c+h)]),n.push([I(o,e)+t+.9*a*Math.cos(c+.5*h),I(o,e)+s+.9*r*Math.sin(c+.5*h)])}return[n,l]}u(rr,"F");function sr(i,t,s,a,r,o,h,e,l){let n=o+I(.1,l),c=[];c.push([I(e,l)+t+.9*a*Math.cos(n-i),I(e,l)+s+.9*r*Math.sin(n-i)]);for(let p=n;p<=h;p+=i)c.push([I(e,l)+t+a*Math.cos(p),I(e,l)+s+r*Math.sin(p)]);return c.push([t+a*Math.cos(h),s+r*Math.sin(h)]),c.push([t+a*Math.cos(h),s+r*Math.sin(h)]),zt(c,null,l)}u(sr,"V");function _r(i,t,s,a,r,o,h,e){let l=[],n=[e.maxRandomnessOffset||1,(e.maxRandomnessOffset||1)+.3],c=[0,0],p=e.disableMultiStroke?1:2,f=e.preserveVertices;for(let m=0;m<p;m++)m===0?l.push({op:"move",data:[h[0],h[1]]}):l.push({op:"move",data:[h[0]+(f?0:I(n[0],e)),h[1]+(f?0:I(n[0],e))]}),c=f?[r,o]:[r+I(n[m],e),o+I(n[m],e)],l.push({op:"bcurveTo",data:[i+I(n[m],e),t+I(n[m],e),s+I(n[m],e),a+I(n[m],e),c[0],c[1]]});return l}u(_r,"Z");function kt(i){return[...i]}u(kt,"Q");function ar(i,t=0){let s=i.length;if(s<3)throw new Error("A curve must have at least three points.");let a=[];if(s===3)a.push(kt(i[0]),kt(i[1]),kt(i[2]),kt(i[2]));else{let r=[];r.push(i[0],i[0]);for(let e=1;e<i.length;e++)r.push(i[e]),e===i.length-1&&r.push(i[e]);let o=[],h=1-t;a.push(kt(r[0]));for(let e=1;e+2<r.length;e++){let l=r[e];o[0]=[l[0],l[1]],o[1]=[l[0]+(h*r[e+1][0]-h*r[e-1][0])/6,l[1]+(h*r[e+1][1]-h*r[e-1][1])/6],o[2]=[r[e+1][0]+(h*r[e][0]-h*r[e+2][0])/6,r[e+1][1]+(h*r[e][1]-h*r[e+2][1])/6],o[3]=[r[e+1][0],r[e+1][1]],a.push(o[1],o[2],o[3])}}return a}u(ar,"H");function _t(i,t){return Math.pow(i[0]-t[0],2)+Math.pow(i[1]-t[1],2)}u(_t,"N");function Fr(i,t,s){let a=_t(t,s);if(a===0)return _t(i,t);let r=((i[0]-t[0])*(s[0]-t[0])+(i[1]-t[1])*(s[1]-t[1]))/a;return r=Math.max(0,Math.min(1,r)),_t(i,ct(t,s,r))}u(Fr,"B");function ct(i,t,s){return[i[0]+(t[0]-i[0])*s,i[1]+(t[1]-i[1])*s]}u(ct,"J");function Le(i,t,s,a){let r=a||[];if(function(e,l){let n=e[l+0],c=e[l+1],p=e[l+2],f=e[l+3],m=3*c[0]-2*n[0]-f[0];m*=m;let g=3*c[1]-2*n[1]-f[1];g*=g;let d=3*p[0]-2*f[0]-n[0];d*=d;let x=3*p[1]-2*f[1]-n[1];return x*=x,m<d&&(m=d),g<x&&(g=x),m+g}(i,t)<s){let e=i[t+0];r.length?(o=r[r.length-1],h=e,Math.sqrt(_t(o,h))>1&&r.push(e)):r.push(e),r.push(i[t+3])}else{let l=i[t+0],n=i[t+1],c=i[t+2],p=i[t+3],f=ct(l,n,.5),m=ct(n,c,.5),g=ct(c,p,.5),d=ct(f,m,.5),x=ct(m,g,.5),y=ct(d,x,.5);Le([l,f,d,y],0,s,r),Le([y,x,g,p],0,s,r)}var o,h;return r}u(Le,"K");function zr(i,t){return Xt(i,0,i.length,t)}u(zr,"U");function Xt(i,t,s,a,r){let o=r||[],h=i[t],e=i[s-1],l=0,n=1;for(let c=t+1;c<s-1;++c){let p=Fr(i[c],h,e);p>l&&(l=p,n=c)}return Math.sqrt(l)>a?(Xt(i,t,n+1,a,o),Xt(i,n,s,a,o)):(o.length||o.push(h),o.push(e)),o}u(Xt,"X");function Se(i,t=.15,s){let a=[],r=(i.length-1)/3;for(let o=0;o<r;o++)Le(i,3*o,t,a);return s&&s>0?Xt(a,0,a.length,s):a}u(Se,"Y");var K="none",ut=class{static{u(this,"et")}constructor(t){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=t||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Math.floor(Math.random()*2**31)}_o(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions}_d(t,s,a){return{shape:t,sets:s||[],options:a||this.defaultOptions}}line(t,s,a,r,o){let h=this._o(o);return this._d("line",[lr(t,s,a,r,h)],h)}rectangle(t,s,a,r,o){let h=this._o(o),e=[],l=Ir(t,s,a,r,h);if(h.fill){let n=[[t,s],[t+a,s],[t+a,s+r],[t,s+r]];h.fillStyle==="solid"?e.push(we([n],h)):e.push(gt([n],h))}return h.stroke!==K&&e.push(l),this._d("rectangle",e,h)}ellipse(t,s,a,r,o){let h=this._o(o),e=[],l=cr(a,r,h),n=Ce(t,s,h,l);if(h.fill)if(h.fillStyle==="solid"){let c=Ce(t,s,h,l).opset;c.type="fillPath",e.push(c)}else e.push(gt([n.estimatedPoints],h));return h.stroke!==K&&e.push(n.opset),this._d("ellipse",e,h)}circle(t,s,a,r){let o=this.ellipse(t,s,a,a,r);return o.shape="circle",o}linearPath(t,s){let a=this._o(s);return this._d("linearPath",[It(t,!1,a)],a)}arc(t,s,a,r,o,h,e=!1,l){let n=this._o(l),c=[],p=Ke(t,s,a,r,o,h,e,!0,n);if(e&&n.fill)if(n.fillStyle==="solid"){let f=Object.assign({},n);f.disableMultiStroke=!0;let m=Ke(t,s,a,r,o,h,!0,!1,f);m.type="fillPath",c.push(m)}else c.push(function(f,m,g,d,x,y,b){let w=f,P=m,M=Math.abs(g/2),A=Math.abs(d/2);M+=I(.01*M,b),A+=I(.01*A,b);let B=x,E=y;for(;B<0;)B+=2*Math.PI,E+=2*Math.PI;E-B>2*Math.PI&&(B=0,E=2*Math.PI);let W=(E-B)/b.curveStepCount,H=[];for(let _=B;_<=E;_+=W)H.push([w+M*Math.cos(_),P+A*Math.sin(_)]);return H.push([w+M*Math.cos(E),P+A*Math.sin(E)]),H.push([w,P]),gt([H],b)}(t,s,a,r,o,h,n));return n.stroke!==K&&c.push(p),this._d("arc",c,n)}curve(t,s){let a=this._o(s),r=[],o=Je(t,a);if(a.fill&&a.fill!==K)if(a.fillStyle==="solid"){let h=Je(t,Object.assign(Object.assign({},a),{disableMultiStroke:!0,roughness:a.roughness?a.roughness+a.fillShapeRoughnessGain:0}));r.push({type:"fillPath",ops:this._mergedShape(h.ops)})}else{let h=[],e=t;if(e.length){let l=typeof e[0][0]=="number"?[e]:e;for(let n of l)n.length<3?h.push(...n):n.length===3?h.push(...Se(ar([n[0],n[0],n[1],n[2]]),10,(1+a.roughness)/2)):h.push(...Se(ar(n),10,(1+a.roughness)/2))}h.length&&r.push(gt([h],a))}return a.stroke!==K&&r.push(o),this._d("curve",r,a)}polygon(t,s){let a=this._o(s),r=[],o=It(t,!0,a);return a.fill&&(a.fillStyle==="solid"?r.push(we([t],a)):r.push(gt([t],a))),a.stroke!==K&&r.push(o),this._d("polygon",r,a)}path(t,s){let a=this._o(s),r=[];if(!t)return this._d("path",r,a);t=(t||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");let o=a.fill&&a.fill!=="transparent"&&a.fill!==K,h=a.stroke!==K,e=!!(a.simplification&&a.simplification<1),l=function(c,p,f){let m=nr(or(Be(c))),g=[],d=[],x=[0,0],y=[],b=u(()=>{y.length>=4&&d.push(...Se(y,p)),y=[]},"i"),w=u(()=>{b(),d.length&&(g.push(d),d=[])},"c");for(let{key:M,data:A}of m)switch(M){case"M":w(),x=[A[0],A[1]],d.push(x);break;case"L":b(),d.push([A[0],A[1]]);break;case"C":if(!y.length){let B=d.length?d[d.length-1]:x;y.push([B[0],B[1]])}y.push([A[0],A[1]]),y.push([A[2],A[3]]),y.push([A[4],A[5]]);break;case"Z":b(),d.push([x[0],x[1]])}if(w(),!f)return g;let P=[];for(let M of g){let A=zr(M,f);A.length&&P.push(A)}return P}(t,1,e?4-4*(a.simplification||1):(1+a.roughness)/2),n=tr(t,a);if(o)if(a.fillStyle==="solid")if(l.length===1){let c=tr(t,Object.assign(Object.assign({},a),{disableMultiStroke:!0,roughness:a.roughness?a.roughness+a.fillShapeRoughnessGain:0}));r.push({type:"fillPath",ops:this._mergedShape(c.ops)})}else r.push(we(l,a));else r.push(gt(l,a));return h&&(e?l.forEach(c=>{r.push(It(c,!1,a))}):r.push(n)),this._d("path",r,a)}opsToPath(t,s){let a="";for(let r of t.ops){let o=typeof s=="number"&&s>=0?r.data.map(h=>+h.toFixed(s)):r.data;switch(r.op){case"move":a+=`M${o[0]} ${o[1]} `;break;case"bcurveTo":a+=`C${o[0]} ${o[1]}, ${o[2]} ${o[3]}, ${o[4]} ${o[5]} `;break;case"lineTo":a+=`L${o[0]} ${o[1]} `}}return a.trim()}toPaths(t){let s=t.sets||[],a=t.options||this.defaultOptions,r=[];for(let o of s){let h=null;switch(o.type){case"path":h={d:this.opsToPath(o),stroke:a.stroke,strokeWidth:a.strokeWidth,fill:K};break;case"fillPath":h={d:this.opsToPath(o),stroke:K,strokeWidth:0,fill:a.fill||K};break;case"fillSketch":h=this.fillSketch(o,a)}h&&r.push(h)}return r}fillSketch(t,s){let a=s.fillWeight;return a<0&&(a=s.strokeWidth/2),{d:this.opsToPath(t),stroke:s.fill||K,strokeWidth:a,fill:K}}_mergedShape(t){return t.filter((s,a)=>a===0||s.op!=="move")}},Ae=class{static{u(this,"st")}constructor(t,s){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.gen=new ut(s)}draw(t){let s=t.sets||[],a=t.options||this.getDefaultOptions(),r=this.ctx,o=t.options.fixedDecimalPlaceDigits;for(let h of s)switch(h.type){case"path":r.save(),r.strokeStyle=a.stroke==="none"?"transparent":a.stroke,r.lineWidth=a.strokeWidth,a.strokeLineDash&&r.setLineDash(a.strokeLineDash),a.strokeLineDashOffset&&(r.lineDashOffset=a.strokeLineDashOffset),this._drawToContext(r,h,o),r.restore();break;case"fillPath":{r.save(),r.fillStyle=a.fill||"";let e=t.shape==="curve"||t.shape==="polygon"||t.shape==="path"?"evenodd":"nonzero";this._drawToContext(r,h,o,e),r.restore();break}case"fillSketch":this.fillSketch(r,h,a)}}fillSketch(t,s,a){let r=a.fillWeight;r<0&&(r=a.strokeWidth/2),t.save(),a.fillLineDash&&t.setLineDash(a.fillLineDash),a.fillLineDashOffset&&(t.lineDashOffset=a.fillLineDashOffset),t.strokeStyle=a.fill||"",t.lineWidth=r,this._drawToContext(t,s,a.fixedDecimalPlaceDigits),t.restore()}_drawToContext(t,s,a,r="nonzero"){t.beginPath();for(let o of s.ops){let h=typeof a=="number"&&a>=0?o.data.map(e=>+e.toFixed(a)):o.data;switch(o.op){case"move":t.moveTo(h[0],h[1]);break;case"bcurveTo":t.bezierCurveTo(h[0],h[1],h[2],h[3],h[4],h[5]);break;case"lineTo":t.lineTo(h[0],h[1])}}s.type==="fillPath"?t.fill(r):t.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(t,s,a,r,o){let h=this.gen.line(t,s,a,r,o);return this.draw(h),h}rectangle(t,s,a,r,o){let h=this.gen.rectangle(t,s,a,r,o);return this.draw(h),h}ellipse(t,s,a,r,o){let h=this.gen.ellipse(t,s,a,r,o);return this.draw(h),h}circle(t,s,a,r){let o=this.gen.circle(t,s,a,r);return this.draw(o),o}linearPath(t,s){let a=this.gen.linearPath(t,s);return this.draw(a),a}polygon(t,s){let a=this.gen.polygon(t,s);return this.draw(a),a}arc(t,s,a,r,o,h,e=!1,l){let n=this.gen.arc(t,s,a,r,o,h,e,l);return this.draw(n),n}curve(t,s){let a=this.gen.curve(t,s);return this.draw(a),a}path(t,s){let a=this.gen.path(t,s);return this.draw(a),a}},jt="http://www.w3.org/2000/svg",Re=class{static{u(this,"ot")}constructor(t,s){this.svg=t,this.gen=new ut(s)}draw(t){let s=t.sets||[],a=t.options||this.getDefaultOptions(),r=this.svg.ownerDocument||window.document,o=r.createElementNS(jt,"g"),h=t.options.fixedDecimalPlaceDigits;for(let e of s){let l=null;switch(e.type){case"path":l=r.createElementNS(jt,"path"),l.setAttribute("d",this.opsToPath(e,h)),l.setAttribute("stroke",a.stroke),l.setAttribute("stroke-width",a.strokeWidth+""),l.setAttribute("fill","none"),a.strokeLineDash&&l.setAttribute("stroke-dasharray",a.strokeLineDash.join(" ").trim()),a.strokeLineDashOffset&&l.setAttribute("stroke-dashoffset",`${a.strokeLineDashOffset}`);break;case"fillPath":l=r.createElementNS(jt,"path"),l.setAttribute("d",this.opsToPath(e,h)),l.setAttribute("stroke","none"),l.setAttribute("stroke-width","0"),l.setAttribute("fill",a.fill||""),t.shape!=="curve"&&t.shape!=="polygon"||l.setAttribute("fill-rule","evenodd");break;case"fillSketch":l=this.fillSketch(r,e,a)}l&&o.appendChild(l)}return o}fillSketch(t,s,a){let r=a.fillWeight;r<0&&(r=a.strokeWidth/2);let o=t.createElementNS(jt,"path");return o.setAttribute("d",this.opsToPath(s,a.fixedDecimalPlaceDigits)),o.setAttribute("stroke",a.fill||""),o.setAttribute("stroke-width",r+""),o.setAttribute("fill","none"),a.fillLineDash&&o.setAttribute("stroke-dasharray",a.fillLineDash.join(" ").trim()),a.fillLineDashOffset&&o.setAttribute("stroke-dashoffset",`${a.fillLineDashOffset}`),o}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(t,s){return this.gen.opsToPath(t,s)}line(t,s,a,r,o){let h=this.gen.line(t,s,a,r,o);return this.draw(h)}rectangle(t,s,a,r,o){let h=this.gen.rectangle(t,s,a,r,o);return this.draw(h)}ellipse(t,s,a,r,o){let h=this.gen.ellipse(t,s,a,r,o);return this.draw(h)}circle(t,s,a,r){let o=this.gen.circle(t,s,a,r);return this.draw(o)}linearPath(t,s){let a=this.gen.linearPath(t,s);return this.draw(a)}polygon(t,s){let a=this.gen.polygon(t,s);return this.draw(a)}arc(t,s,a,r,o,h,e=!1,l){let n=this.gen.arc(t,s,a,r,o,h,e,l);return this.draw(n)}curve(t,s){let a=this.gen.curve(t,s);return this.draw(a)}path(t,s){let a=this.gen.path(t,s);return this.draw(a)}},k={canvas:u((i,t)=>new Ae(i,t),"canvas"),svg:u((i,t)=>new Re(i,t),"svg"),generator:u(i=>new ut(i),"generator"),newSeed:u(()=>ut.newSeed(),"newSeed")};var Xr=u((i,t)=>{var s=i.x,a=i.y,r=t.x-s,o=t.y-a,h=i.width/2,e=i.height/2,l,n;return Math.abs(o)*h>Math.abs(r)*e?(o<0&&(e=-e),l=o===0?0:e*r/o,n=e):(r<0&&(h=-h),l=h,n=r===0?0:h*o/r),{x:s+l,y:a+n}},"intersectRect"),ht=Xr;function Yr(i,t){t&&i.attr("style",t)}u(Yr,"applyStyle");async function qr(i){let t=Q(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")),s=t.append("xhtml:div"),a=i.label;i.label&&ze(i.label)&&(a=await Xe(i.label.replace(Ye.lineBreakRegex,`
`),z()));let r=i.isNode?"nodeLabel":"edgeLabel";return s.html('<span class="'+r+'" '+(i.labelStyle?'style="'+i.labelStyle+'"':"")+">"+a+"</span>"),Yr(s,i.labelStyle),s.style("display","inline-block"),s.style("padding-right","1px"),s.style("white-space","nowrap"),s.attr("xmlns","http://www.w3.org/1999/xhtml"),t.node()}u(qr,"addHtmlLabel");var Zr=u(async(i,t,s,a)=>{let r=i||"";if(typeof r=="object"&&(r=r[0]),Y(z().flowchart.htmlLabels)){r=r.replace(/\\n|\n/g,"<br />"),R.info("vertexText"+r);let o={isNode:a,label:Ht(r).replace(/fa[blrs]?:fa-[\w-]+/g,e=>`<i class='${e.replace(":"," ")}'></i>`),labelStyle:t&&t.replace("fill:","color:")};return await qr(o)}else{let o=document.createElementNS("http://www.w3.org/2000/svg","text");o.setAttribute("style",t.replace("color:","fill:"));let h=[];typeof r=="string"?h=r.split(/\\n|\n|<br\s*\/?>/gi):Array.isArray(r)?h=r:h=[];for(let e of h){let l=document.createElementNS("http://www.w3.org/2000/svg","tspan");l.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),l.setAttribute("dy","1em"),l.setAttribute("x","0"),s?l.setAttribute("class","title-row"):l.setAttribute("class","row"),l.textContent=e.trim(),o.appendChild(l)}return o}},"createLabel"),rt=Zr;var et=u((i,t,s,a,r)=>["M",i+r,t,"H",i+s-r,"A",r,r,0,0,1,i+s,t+r,"V",t+a-r,"A",r,r,0,0,1,i+s-r,t+a,"H",i+r,"A",r,r,0,0,1,i,t+a-r,"V",t+r,"A",r,r,0,0,1,i+r,t,"Z"].join(" "),"createRoundedRectPathD");var pr=u(i=>{let{handDrawnSeed:t}=z();return{fill:i,hachureAngle:120,hachureGap:4,fillWeight:2,roughness:.7,stroke:i,seed:t}},"solidStateFill"),st=u(i=>{let t=Qr([...i.cssCompiledStyles||[],...i.cssStyles||[]]);return{stylesMap:t,stylesArray:[...t]}},"compileStyles"),Qr=u(i=>{let t=new Map;return i.forEach(s=>{let[a,r]=s.split(":");t.set(a.trim(),r?.trim())}),t},"styles2Map"),$=u(i=>{let{stylesArray:t}=st(i),s=[],a=[],r=[],o=[];return t.forEach(h=>{let e=h[0];e==="color"||e==="font-size"||e==="font-family"||e==="font-weight"||e==="font-style"||e==="text-decoration"||e==="text-align"||e==="text-transform"||e==="line-height"||e==="letter-spacing"||e==="word-spacing"||e==="text-shadow"||e==="text-overflow"||e==="white-space"||e==="word-wrap"||e==="word-break"||e==="overflow-wrap"||e==="hyphens"?s.push(h.join(":")+" !important"):(a.push(h.join(":")+" !important"),e.includes("stroke")&&r.push(h.join(":")+" !important"),e==="fill"&&o.push(h.join(":")+" !important"))}),{labelStyles:s.join(";"),nodeStyles:a.join(";"),stylesArray:t,borderStyles:r,backgroundStyles:o}},"styles2String"),N=u((i,t)=>{let{themeVariables:s,handDrawnSeed:a}=z(),{nodeBorder:r,mainBkg:o}=s,{stylesMap:h}=st(i);return Object.assign({roughness:.7,fill:h.get("fill")||o,fillStyle:"hachure",fillWeight:4,hachureGap:5.2,stroke:h.get("stroke")||r,seed:a,strokeWidth:h.get("stroke-width")?.replace("px","")||1.3,fillLineDash:[0,0]},t)},"userNodeOverrides");var fr=u(async(i,t)=>{R.info("Creating subgraph rect for ",t.id,t);let s=z(),{themeVariables:a,handDrawnSeed:r}=s,{clusterBkg:o,clusterBorder:h}=a,{labelStyles:e,nodeStyles:l,borderStyles:n,backgroundStyles:c}=$(t),p=i.insert("g").attr("class","cluster "+t.cssClasses).attr("id",t.id).attr("data-look",t.look),f=Y(s.flowchart.htmlLabels),m=p.insert("g").attr("class","cluster-label "),g=await mt(m,t.label,{style:t.labelStyle,useHtmlLabels:f,isNode:!0}),d=g.getBBox();if(Y(s.flowchart.htmlLabels)){let B=g.children[0],E=Q(g);d=B.getBoundingClientRect(),E.attr("width",d.width),E.attr("height",d.height)}let x=t.width<=d.width+t.padding?d.width+t.padding:t.width;t.width<=d.width+t.padding?t.diff=(x-t.width)/2-t.padding:t.diff=-t.padding;let y=t.height,b=t.x-x/2,w=t.y-y/2;R.trace("Data ",t,JSON.stringify(t));let P;if(t.look==="handDrawn"){let B=k.svg(p),E=N(t,{roughness:.7,fill:o,stroke:h,fillWeight:3,seed:r}),W=B.path(et(b,w,x,y,0),E);P=p.insert(()=>(R.debug("Rough node insert CXC",W),W),":first-child"),P.select("path:nth-child(2)").attr("style",n.join(";")),P.select("path").attr("style",c.join(";").replace("fill","stroke"))}else P=p.insert("rect",":first-child"),P.attr("style",l).attr("rx",t.rx).attr("ry",t.ry).attr("x",b).attr("y",w).attr("width",x).attr("height",y);let{subGraphTitleTopMargin:M}=Vt(s);if(m.attr("transform",`translate(${t.x-d.width/2}, ${t.y-t.height/2+M})`),e){let B=m.select("span");B&&B.attr("style",e)}let A=P.node().getBBox();return t.offsetX=0,t.width=A.width,t.height=A.height,t.offsetY=d.height-t.padding/2,t.intersect=function(B){return ht(t,B)},{cluster:p,labelBBox:d}},"rect"),Ur=u((i,t)=>{let s=i.insert("g").attr("class","note-cluster").attr("id",t.id),a=s.insert("rect",":first-child"),r=0*t.padding,o=r/2;a.attr("rx",t.rx).attr("ry",t.ry).attr("x",t.x-t.width/2-o).attr("y",t.y-t.height/2-o).attr("width",t.width+r).attr("height",t.height+r).attr("fill","none");let h=a.node().getBBox();return t.width=h.width,t.height=h.height,t.intersect=function(e){return ht(t,e)},{cluster:s,labelBBox:{width:0,height:0}}},"noteGroup"),Jr=u(async(i,t)=>{let s=z(),{themeVariables:a,handDrawnSeed:r}=s,{altBackground:o,compositeBackground:h,compositeTitleBackground:e,nodeBorder:l}=a,n=i.insert("g").attr("class",t.cssClasses).attr("id",t.id).attr("data-id",t.id).attr("data-look",t.look),c=n.insert("g",":first-child"),p=n.insert("g").attr("class","cluster-label"),f=n.append("rect"),m=p.node().appendChild(await rt(t.label,t.labelStyle,void 0,!0)),g=m.getBBox();if(Y(s.flowchart.htmlLabels)){let W=m.children[0],H=Q(m);g=W.getBoundingClientRect(),H.attr("width",g.width),H.attr("height",g.height)}let d=0*t.padding,x=d/2,y=(t.width<=g.width+t.padding?g.width+t.padding:t.width)+d;t.width<=g.width+t.padding?t.diff=(y-t.width)/2-t.padding:t.diff=-t.padding;let b=t.height+d,w=t.height+d-g.height-6,P=t.x-y/2,M=t.y-b/2;t.width=y;let A=t.y-t.height/2-x+g.height+2,B;if(t.look==="handDrawn"){let W=t.cssClasses.includes("statediagram-cluster-alt"),H=k.svg(n),_=t.rx||t.ry?H.path(et(P,M,y,b,10),{roughness:.7,fill:e,fillStyle:"solid",stroke:l,seed:r}):H.rectangle(P,M,y,b,{seed:r});B=n.insert(()=>_,":first-child");let F=H.rectangle(P,A,y,w,{fill:W?o:h,fillStyle:W?"hachure":"solid",stroke:l,seed:r});B=n.insert(()=>_,":first-child"),f=n.insert(()=>F)}else B=c.insert("rect",":first-child"),B.attr("class","outer").attr("x",P).attr("y",M).attr("width",y).attr("height",b).attr("data-look",t.look),f.attr("class","inner").attr("x",P).attr("y",A).attr("width",y).attr("height",w);p.attr("transform",`translate(${t.x-g.width/2}, ${M+1-(Y(s.flowchart.htmlLabels)?0:3)})`);let E=B.node().getBBox();return t.height=E.height,t.offsetX=0,t.offsetY=g.height-t.padding/2,t.labelBBox=g,t.intersect=function(W){return ht(t,W)},{cluster:n,labelBBox:g}},"roundedWithTitle"),Kr=u((i,t)=>{let s=z(),{themeVariables:a,handDrawnSeed:r}=s,{nodeBorder:o}=a,h=i.insert("g").attr("class",t.cssClasses).attr("id",t.id).attr("data-look",t.look),e=h.insert("g",":first-child"),l=0*t.padding,n=t.width+l;t.diff=-t.padding;let c=t.height+l,p=t.x-n/2,f=t.y-c/2;t.width=n;let m;if(t.look==="handDrawn"){let x=k.svg(h).rectangle(p,f,n,c,{fill:"lightgrey",roughness:.5,strokeLineDash:[5],stroke:o,seed:r});m=h.insert(()=>x,":first-child")}else m=e.insert("rect",":first-child"),m.attr("class","divider").attr("x",p).attr("y",f).attr("width",n).attr("height",c).attr("data-look",t.look);let g=m.node().getBBox();return t.height=g.height,t.offsetX=0,t.offsetY=0,t.intersect=function(d){return ht(t,d)},{cluster:h,labelBBox:{}}},"divider"),ts=fr,es={rect:fr,squareRect:ts,roundedWithTitle:Jr,noteGroup:Ur,divider:Kr},mr=new Map,la=u(async(i,t)=>{let s=t.shape||"rect",a=await es[s](i,t);return mr.set(t.id,a),a},"insertCluster");var ca=u(()=>{mr=new Map},"clear");var ur=u((i,t,s,a,r)=>{t.arrowTypeStart&&gr(i,"start",t.arrowTypeStart,s,a,r),t.arrowTypeEnd&&gr(i,"end",t.arrowTypeEnd,s,a,r)},"addEdgeMarkers"),rs={arrow_cross:"cross",arrow_point:"point",arrow_barb:"barb",arrow_circle:"circle",aggregation:"aggregation",extension:"extension",composition:"composition",dependency:"dependency",lollipop:"lollipop"},gr=u((i,t,s,a,r,o)=>{let h=rs[s];if(!h){R.warn(`Unknown arrow type: ${s}`);return}let e=t==="start"?"Start":"End";i.attr(`marker-${t}`,`url(${a}#${r}_${o}-${h}${e})`)},"addEdgeMarker");var Zt=new Map,X=new Map,$a=u(()=>{Zt.clear(),X.clear()},"clear"),vt=u(i=>i?i.reduce((s,a)=>s+";"+a,""):"","getLabelStyles"),Pa=u(async(i,t)=>{let s=Y(z().flowchart.htmlLabels),a=await mt(i,t.label,{style:vt(t.labelStyle),useHtmlLabels:s,addSvgBackground:!0,isNode:!1});R.info("abc82",t,t.labelType);let r=i.insert("g").attr("class","edgeLabel"),o=r.insert("g").attr("class","label");o.node().appendChild(a);let h=a.getBBox();if(s){let l=a.children[0],n=Q(a);h=l.getBoundingClientRect(),n.attr("width",h.width),n.attr("height",h.height)}o.attr("transform","translate("+-h.width/2+", "+-h.height/2+")"),Zt.set(t.id,r),t.width=h.width,t.height=h.height;let e;if(t.startLabelLeft){let l=await rt(t.startLabelLeft,vt(t.labelStyle)),n=i.insert("g").attr("class","edgeTerminals"),c=n.insert("g").attr("class","inner");e=c.node().appendChild(l);let p=l.getBBox();c.attr("transform","translate("+-p.width/2+", "+-p.height/2+")"),X.get(t.id)||X.set(t.id,{}),X.get(t.id).startLeft=n,qt(e,t.startLabelLeft)}if(t.startLabelRight){let l=await rt(t.startLabelRight,vt(t.labelStyle)),n=i.insert("g").attr("class","edgeTerminals"),c=n.insert("g").attr("class","inner");e=n.node().appendChild(l),c.node().appendChild(l);let p=l.getBBox();c.attr("transform","translate("+-p.width/2+", "+-p.height/2+")"),X.get(t.id)||X.set(t.id,{}),X.get(t.id).startRight=n,qt(e,t.startLabelRight)}if(t.endLabelLeft){let l=await rt(t.endLabelLeft,vt(t.labelStyle)),n=i.insert("g").attr("class","edgeTerminals"),c=n.insert("g").attr("class","inner");e=c.node().appendChild(l);let p=l.getBBox();c.attr("transform","translate("+-p.width/2+", "+-p.height/2+")"),n.node().appendChild(l),X.get(t.id)||X.set(t.id,{}),X.get(t.id).endLeft=n,qt(e,t.endLabelLeft)}if(t.endLabelRight){let l=await rt(t.endLabelRight,vt(t.labelStyle)),n=i.insert("g").attr("class","edgeTerminals"),c=n.insert("g").attr("class","inner");e=c.node().appendChild(l);let p=l.getBBox();c.attr("transform","translate("+-p.width/2+", "+-p.height/2+")"),n.node().appendChild(l),X.get(t.id)||X.set(t.id,{}),X.get(t.id).endRight=n,qt(e,t.endLabelRight)}return a},"insertEdgeLabel");function qt(i,t){z().flowchart.htmlLabels&&i&&(i.style.width=t.length*9+"px",i.style.height="12px")}u(qt,"setTerminalWidth");var Ca=u((i,t)=>{R.debug("Moving label abc88 ",i.id,i.label,Zt.get(i.id),t);let s=t.updatedPath?t.updatedPath:t.originalPath,a=z(),{subGraphTitleTotalMargin:r}=Vt(a);if(i.label){let o=Zt.get(i.id),h=i.x,e=i.y;if(s){let l=ft.calcLabelPosition(s);R.debug("Moving label "+i.label+" from (",h,",",e,") to (",l.x,",",l.y,") abc88"),t.updatedPath&&(h=l.x,e=l.y)}o.attr("transform",`translate(${h}, ${e+r/2})`)}if(i.startLabelLeft){let o=X.get(i.id).startLeft,h=i.x,e=i.y;if(s){let l=ft.calcTerminalLabelPosition(i.arrowTypeStart?10:0,"start_left",s);h=l.x,e=l.y}o.attr("transform",`translate(${h}, ${e})`)}if(i.startLabelRight){let o=X.get(i.id).startRight,h=i.x,e=i.y;if(s){let l=ft.calcTerminalLabelPosition(i.arrowTypeStart?10:0,"start_right",s);h=l.x,e=l.y}o.attr("transform",`translate(${h}, ${e})`)}if(i.endLabelLeft){let o=X.get(i.id).endLeft,h=i.x,e=i.y;if(s){let l=ft.calcTerminalLabelPosition(i.arrowTypeEnd?10:0,"end_left",s);h=l.x,e=l.y}o.attr("transform",`translate(${h}, ${e})`)}if(i.endLabelRight){let o=X.get(i.id).endRight,h=i.x,e=i.y;if(s){let l=ft.calcTerminalLabelPosition(i.arrowTypeEnd?10:0,"end_right",s);h=l.x,e=l.y}o.attr("transform",`translate(${h}, ${e})`)}},"positionEdgeLabel"),ss=u((i,t)=>{let s=i.x,a=i.y,r=Math.abs(t.x-s),o=Math.abs(t.y-a),h=i.width/2,e=i.height/2;return r>=h||o>=e},"outsideNode"),as=u((i,t,s)=>{R.debug(`intersection calc abc89:
  outsidePoint: ${JSON.stringify(t)}
  insidePoint : ${JSON.stringify(s)}
  node        : x:${i.x} y:${i.y} w:${i.width} h:${i.height}`);let a=i.x,r=i.y,o=Math.abs(a-s.x),h=i.width/2,e=s.x<t.x?h-o:h+o,l=i.height/2,n=Math.abs(t.y-s.y),c=Math.abs(t.x-s.x);if(Math.abs(r-t.y)*h>Math.abs(a-t.x)*l){let p=s.y<t.y?t.y-l-r:r-l-t.y;e=c*p/n;let f={x:s.x<t.x?s.x+e:s.x-c+e,y:s.y<t.y?s.y+n-p:s.y-n+p};return e===0&&(f.x=t.x,f.y=t.y),c===0&&(f.x=t.x),n===0&&(f.y=t.y),R.debug(`abc89 top/bottom calc, Q ${n}, q ${p}, R ${c}, r ${e}`,f),f}else{s.x<t.x?e=t.x-h-a:e=a-h-t.x;let p=n*e/c,f=s.x<t.x?s.x+c-e:s.x-c+e,m=s.y<t.y?s.y+p:s.y-p;return R.debug(`sides calc abc89, Q ${n}, q ${p}, R ${c}, r ${e}`,{_x:f,_y:m}),e===0&&(f=t.x,m=t.y),c===0&&(f=t.x),n===0&&(m=t.y),{x:f,y:m}}},"intersection"),dr=u((i,t)=>{R.warn("abc88 cutPathAtIntersect",i,t);let s=[],a=i[0],r=!1;return i.forEach(o=>{if(R.info("abc88 checking point",o,t),!ss(t,o)&&!r){let h=as(t,a,o);R.debug("abc88 inside",o,a,h),R.debug("abc88 intersection",h,t);let e=!1;s.forEach(l=>{e=e||l.x===h.x&&l.y===h.y}),s.some(l=>l.x===h.x&&l.y===h.y)?R.warn("abc88 no intersect",h,s):s.push(h),r=!0}else R.warn("abc88 outside",o,a),a=o,r||s.push(o)}),R.debug("returning points",s),s},"cutPathAtIntersect");function os(i){let t=[],s=[];for(let a=1;a<i.length-1;a++){let r=i[a-1],o=i[a],h=i[a+1];(r.x===o.x&&o.y===h.y&&Math.abs(o.x-h.x)>5&&Math.abs(o.y-r.y)>5||r.y===o.y&&o.x===h.x&&Math.abs(o.x-r.x)>5&&Math.abs(o.y-h.y)>5)&&(t.push(o),s.push(a))}return{cornerPoints:t,cornerPointPositions:s}}u(os,"extractCornerPoints");var yr=u(function(i,t,s){let a=t.x-i.x,r=t.y-i.y,o=Math.sqrt(a*a+r*r),h=s/o;return{x:t.x-h*a,y:t.y-h*r}},"findAdjacentPoint"),ns=u(function(i){let{cornerPointPositions:t}=os(i),s=[];for(let a=0;a<i.length;a++)if(t.includes(a)){let r=i[a-1],o=i[a+1],h=i[a],e=yr(r,h,5),l=yr(o,h,5),n=l.x-e.x,c=l.y-e.y;s.push(e);let p=Math.sqrt(2)*2,f={x:h.x,y:h.y};if(Math.abs(o.x-r.x)>10&&Math.abs(o.y-r.y)>=10){R.debug("Corner point fixing",Math.abs(o.x-r.x),Math.abs(o.y-r.y));let m=5;h.x===e.x?f={x:n<0?e.x-m+p:e.x+m-p,y:c<0?e.y-p:e.y+p}:f={x:n<0?e.x-p:e.x+p,y:c<0?e.y-m+p:e.y+m-p}}else R.debug("Corner point skipping fixing",Math.abs(o.x-r.x),Math.abs(o.y-r.y));s.push(f,l)}else s.push(i[a]);return s},"fixCorners"),Da=u(function(i,t,s,a,r,o,h){let{handDrawnSeed:e}=z(),l=t.points,n=!1,c=r;var p=o;p.intersect&&c.intersect&&(l=l.slice(1,t.points.length-1),l.unshift(c.intersect(l[0])),R.debug("Last point APA12",t.start,"-->",t.end,l[l.length-1],p,p.intersect(l[l.length-1])),l.push(p.intersect(l[l.length-1]))),t.toCluster&&(R.info("to cluster abc88",s.get(t.toCluster)),l=dr(t.points,s.get(t.toCluster).node),n=!0),t.fromCluster&&(R.debug("from cluster abc88",s.get(t.fromCluster),JSON.stringify(l,null,2)),l=dr(l.reverse(),s.get(t.fromCluster).node).reverse(),n=!0);let f=l.filter(E=>!Number.isNaN(E.y));f=ns(f);let m=f[f.length-1];if(f.length>1){m=f[f.length-1];let E=f[f.length-2],W=(m.x-E.x)/2,H=(m.y-E.y)/2,_={x:E.x+W,y:E.y+H};f.splice(-1,0,_)}let g=Ze;t.curve&&(g=t.curve);let{x:d,y:x}=Qe(t),y=qe().x(d).y(x).curve(g),b;switch(t.thickness){case"normal":b="edge-thickness-normal";break;case"thick":b="edge-thickness-thick";break;case"invisible":b="edge-thickness-invisible";break;default:b="edge-thickness-normal"}switch(t.pattern){case"solid":b+=" edge-pattern-solid";break;case"dotted":b+=" edge-pattern-dotted";break;case"dashed":b+=" edge-pattern-dashed";break;default:b+=" edge-pattern-solid"}let w,P=y(f),M=Array.isArray(t.style)?t.style:[t.style];if(t.look==="handDrawn"){let E=k.svg(i);Object.assign([],f);let W=E.path(P,{roughness:.3,seed:e});b+=" transition",w=Q(W).select("path").attr("id",t.id).attr("class"," "+b+(t.classes?" "+t.classes:"")).attr("style",M?M.reduce((_,F)=>_+";"+F,""):"");let H=w.attr("d");w.attr("d",H),i.node().appendChild(w.node())}else w=i.append("path").attr("d",P).attr("id",t.id).attr("class"," "+b+(t.classes?" "+t.classes:"")).attr("style",M?M.reduce((E,W)=>E+";"+W,""):"");let A="";(z().flowchart.arrowMarkerAbsolute||z().state.arrowMarkerAbsolute)&&(A=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,A=A.replace(/\(/g,"\\(").replace(/\)/g,"\\)")),R.info("arrowTypeStart",t.arrowTypeStart),R.info("arrowTypeEnd",t.arrowTypeEnd),ur(w,t,A,h,a);let B={};return n&&(B.updatedPath=l),B.originalPath=t.points,B},"insertEdge");var is=u((i,t,s,a)=>{t.forEach(r=>{ys[r](i,s,a)})},"insertMarkers"),ls=u((i,t,s)=>{R.trace("Making markers for ",s),i.append("defs").append("marker").attr("id",s+"_"+t+"-extensionStart").attr("class","marker extension "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 1,7 L18,13 V 1 Z"),i.append("defs").append("marker").attr("id",s+"_"+t+"-extensionEnd").attr("class","marker extension "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 1,1 V 13 L18,7 Z")},"extension"),cs=u((i,t,s)=>{i.append("defs").append("marker").attr("id",s+"_"+t+"-compositionStart").attr("class","marker composition "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),i.append("defs").append("marker").attr("id",s+"_"+t+"-compositionEnd").attr("class","marker composition "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z")},"composition"),hs=u((i,t,s)=>{i.append("defs").append("marker").attr("id",s+"_"+t+"-aggregationStart").attr("class","marker aggregation "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),i.append("defs").append("marker").attr("id",s+"_"+t+"-aggregationEnd").attr("class","marker aggregation "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z")},"aggregation"),ps=u((i,t,s)=>{i.append("defs").append("marker").attr("id",s+"_"+t+"-dependencyStart").attr("class","marker dependency "+t).attr("refX",6).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 5,7 L9,13 L1,7 L9,1 Z"),i.append("defs").append("marker").attr("id",s+"_"+t+"-dependencyEnd").attr("class","marker dependency "+t).attr("refX",13).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L14,7 L9,1 Z")},"dependency"),fs=u((i,t,s)=>{i.append("defs").append("marker").attr("id",s+"_"+t+"-lollipopStart").attr("class","marker lollipop "+t).attr("refX",13).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("circle").attr("stroke","black").attr("fill","transparent").attr("cx",7).attr("cy",7).attr("r",6),i.append("defs").append("marker").attr("id",s+"_"+t+"-lollipopEnd").attr("class","marker lollipop "+t).attr("refX",1).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("circle").attr("stroke","black").attr("fill","transparent").attr("cx",7).attr("cy",7).attr("r",6)},"lollipop"),ms=u((i,t,s)=>{i.append("marker").attr("id",s+"_"+t+"-pointEnd").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",5).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0"),i.append("marker").attr("id",s+"_"+t+"-pointStart").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",4.5).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").append("path").attr("d","M 0 5 L 10 10 L 10 0 z").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0")},"point"),gs=u((i,t,s)=>{i.append("marker").attr("id",s+"_"+t+"-circleEnd").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",11).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("circle").attr("cx","5").attr("cy","5").attr("r","5").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0"),i.append("marker").attr("id",s+"_"+t+"-circleStart").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",-1).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("circle").attr("cx","5").attr("cy","5").attr("r","5").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0")},"circle"),us=u((i,t,s)=>{i.append("marker").attr("id",s+"_"+t+"-crossEnd").attr("class","marker cross "+t).attr("viewBox","0 0 11 11").attr("refX",12).attr("refY",5.2).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("path").attr("d","M 1,1 l 9,9 M 10,1 l -9,9").attr("class","arrowMarkerPath").style("stroke-width",2).style("stroke-dasharray","1,0"),i.append("marker").attr("id",s+"_"+t+"-crossStart").attr("class","marker cross "+t).attr("viewBox","0 0 11 11").attr("refX",-1).attr("refY",5.2).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("path").attr("d","M 1,1 l 9,9 M 10,1 l -9,9").attr("class","arrowMarkerPath").style("stroke-width",2).style("stroke-dasharray","1,0")},"cross"),ds=u((i,t,s)=>{i.append("defs").append("marker").attr("id",s+"_"+t+"-barbEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",14).attr("markerUnits","userSpaceOnUse").attr("orient","auto").append("path").attr("d","M 19,7 L9,13 L14,7 L9,1 Z")},"barb"),ys={extension:ls,composition:cs,aggregation:hs,dependency:ps,lollipop:fs,point:ms,circle:gs,cross:us,barb:ds},Ba=is;var C=u(async(i,t,s)=>{let a,r=t.useHtmlLabels||Y(z().flowchart.htmlLabels);s?a=s:a="node default";let o=i.insert("g").attr("class",a).attr("id",t.domId||t.id),h=o.insert("g").attr("class","label").attr("style",t.labelStyle),e;t.label===void 0?e="":e=typeof t.label=="string"?t.label:t.label[0];let l;l=await mt(h,Fe(Ht(e),z()),{useHtmlLabels:r,width:t.width||z().flowchart.wrappingWidth,cssClasses:"markdown-node-label",style:t.labelStyle,addSvgBackground:!!t.icon||!!t.img});let n=l.getBBox(),c=t.padding/2;if(Y(z().flowchart.htmlLabels)){let p=l.children[0],f=Q(l),m=p.getElementsByTagName("img");if(m){let g=e.replace(/<img[^>]*>/g,"").trim()==="";await Promise.all([...m].map(d=>new Promise(x=>{function y(){if(d.style.display="flex",d.style.flexDirection="column",g){let b=z().fontSize?z().fontSize:window.getComputedStyle(document.body).fontSize,P=parseInt(b,10)*5+"px";d.style.minWidth=P,d.style.maxWidth=P}else d.style.width="100%";x(d)}u(y,"setupImage"),setTimeout(()=>{d.complete&&y()}),d.addEventListener("error",y),d.addEventListener("load",y)})))}n=p.getBoundingClientRect(),f.attr("width",n.width),f.attr("height",n.height)}return r?h.attr("transform","translate("+-n.width/2+", "+-n.height/2+")"):h.attr("transform","translate(0, "+-n.height/2+")"),t.centerLabel&&h.attr("transform","translate("+-n.width/2+", "+-n.height/2+")"),h.insert("rect",":first-child"),{shapeSvg:o,bbox:n,halfPadding:c,label:h}},"labelHelper"),v=u((i,t)=>{let s=t.node().getBBox();i.width=s.width,i.height=s.height},"updateNodeBounds");var D=u((i,t)=>(i.look==="handDrawn"?"rough-node":"node")+" "+i.cssClasses+" "+(t||""),"getNodeClasses");function V(i){let t=i.map((s,a)=>`${a===0?"M":"L"}${s.x},${s.y}`);return t.push("Z"),t.join(" ")}u(V,"createPathFromPoints");function tt(i,t,s,a,r,o){let h=[],l=s-i,n=a-t,c=l/o,p=2*Math.PI/c,f=t+n/2;for(let m=0;m<=50;m++){let g=m/50,d=i+g*l,x=f+r*Math.sin(p*(d-i));h.push({x:d,y:x})}return h}u(tt,"generateFullSineWavePoints");function Qt(i,t,s,a,r,o){let h=[],e=r*Math.PI/180,c=(o*Math.PI/180-e)/(a-1);for(let p=0;p<a;p++){let f=e+p*c,m=i+s*Math.cos(f),g=t+s*Math.sin(f);h.push({x:-m,y:-g})}return h}u(Qt,"generateCirclePoints");function xs(i,t){return i.intersect(t)}u(xs,"intersectNode");var xr=xs;function bs(i,t,s,a){var r=i.x,o=i.y,h=r-a.x,e=o-a.y,l=Math.sqrt(t*t*e*e+s*s*h*h),n=Math.abs(t*s*h/l);a.x<r&&(n=-n);var c=Math.abs(t*s*e/l);return a.y<o&&(c=-c),{x:r+n,y:o+c}}u(bs,"intersectEllipse");var Ut=bs;function ws(i,t,s){return Ut(i,t,t,s)}u(ws,"intersectCircle");var br=ws;function Ss(i,t,s,a){var r,o,h,e,l,n,c,p,f,m,g,d,x,y,b;if(r=t.y-i.y,h=i.x-t.x,l=t.x*i.y-i.x*t.y,f=r*s.x+h*s.y+l,m=r*a.x+h*a.y+l,!(f!==0&&m!==0&&wr(f,m))&&(o=a.y-s.y,e=s.x-a.x,n=a.x*s.y-s.x*a.y,c=o*i.x+e*i.y+n,p=o*t.x+e*t.y+n,!(c!==0&&p!==0&&wr(c,p))&&(g=r*e-o*h,g!==0)))return d=Math.abs(g/2),x=h*n-e*l,y=x<0?(x-d)/g:(x+d)/g,x=o*l-r*n,b=x<0?(x-d)/g:(x+d)/g,{x:y,y:b}}u(Ss,"intersectLine");function wr(i,t){return i*t>0}u(wr,"sameSign");var Sr=Ss;function ks(i,t,s){let a=i.x,r=i.y,o=[],h=Number.POSITIVE_INFINITY,e=Number.POSITIVE_INFINITY;typeof t.forEach=="function"?t.forEach(function(c){h=Math.min(h,c.x),e=Math.min(e,c.y)}):(h=Math.min(h,t.x),e=Math.min(e,t.y));let l=a-i.width/2-h,n=r-i.height/2-e;for(let c=0;c<t.length;c++){let p=t[c],f=t[c<t.length-1?c+1:0],m=Sr(i,s,{x:l+p.x,y:n+p.y},{x:l+f.x,y:n+f.y});m&&o.push(m)}return o.length?(o.length>1&&o.sort(function(c,p){let f=c.x-s.x,m=c.y-s.y,g=Math.sqrt(f*f+m*m),d=p.x-s.x,x=p.y-s.y,y=Math.sqrt(d*d+x*x);return g<y?-1:g===y?0:1}),o[0]):i}u(ks,"intersectPolygon");var kr=ks;var S={node:xr,circle:br,ellipse:Ut,polygon:kr,rect:ht};var pt=u(async(i,t,s)=>{let{labelStyles:a,nodeStyles:r}=$(t);t.labelStyle=a;let{shapeSvg:o,bbox:h}=await C(i,t,D(t)),e=Math.max(h.width+s.labelPaddingX*2,t?.width||0),l=Math.max(h.height+s.labelPaddingY*2,t?.height||0),n=-e/2,c=-l/2,p,{rx:f,ry:m}=t,{cssStyles:g}=t;if(s?.rx&&s.ry&&(f=s.rx,m=s.ry),t.look==="handDrawn"){let d=k.svg(o),x=N(t,{}),y=f||m?d.path(et(n,c,e,l,f||0),x):d.rectangle(n,c,e,l,x);p=o.insert(()=>y,":first-child"),p.attr("class","basic label-container").attr("style",g)}else p=o.insert("rect",":first-child"),p.attr("class","basic label-container").attr("style",r).attr("rx",f).attr("ry",m).attr("x",n).attr("y",c).attr("width",e).attr("height",l);return v(t,p),t.intersect=function(d){return S.rect(t,d)},o},"drawRect");var Mr=u(async(i,t)=>pt(i,t,{rx:5,ry:5,classes:"flowchart-node"}),"state");var Jt=u(async(i,t)=>{let s={rx:5,ry:5,classes:"",labelPaddingX:(t?.padding||0)*1,labelPaddingY:(t?.padding||0)*1};return pt(i,t,s)},"roundedRect");var dt=u(async(i,t)=>{let s={rx:0,ry:0,classes:"",labelPaddingX:(t?.padding||0)*2,labelPaddingY:(t?.padding||0)*1};return pt(i,t,s)},"squareRect");var $t=u((i,t,{config:{themeVariables:s}})=>{let{lineColor:a}=s,r=i.insert("g").attr("class","node default").attr("id",t.domId||t.id),o;if(t.look==="handDrawn"){let e=k.svg(r).circle(0,0,14,pr(a));o=r.insert(()=>e)}else o=r.insert("circle",":first-child");return o.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14),v(t,o),t.intersect=function(h){return S.circle(t,7,h)},r},"stateStart");var Pt=u((i,t,{config:{themeVariables:s}})=>{let{labelStyles:a,nodeStyles:r}=$(t);t.labelStyle=a;let{cssStyles:o}=t,{lineColor:h,stateBorder:e,nodeBorder:l}=s,n=i.insert("g").attr("class","node default").attr("id",t.domId||t.id),c=k.svg(n),p=N(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let f=c.circle(0,0,14,{...p,stroke:h,strokeWidth:2}),m=e??l,g=c.circle(0,0,5,{...p,fill:m,stroke:m,strokeWidth:2,fillStyle:"solid"}),d=n.insert(()=>f,":first-child");return d.insert(()=>g),o&&d.selectAll("path").attr("style",o),r&&d.selectAll("path").attr("style",r),v(t,d),t.intersect=function(x){return S.circle(t,7,x)},n},"stateEnd");var Kt=u((i,t,{dir:s,config:{state:a,themeVariables:r}})=>{let{nodeStyles:o}=$(t);t.label="";let h=i.insert("g").attr("class",D(t)).attr("id",t.domId??t.id),{cssStyles:e}=t,l=Math.max(70,t?.width??0),n=Math.max(10,t?.height??0);s==="LR"&&(l=Math.max(10,t?.width??0),n=Math.max(70,t?.height??0));let c=-1*l/2,p=-1*n/2,f=k.svg(h),m=N(t,{stroke:r.lineColor,fill:r.lineColor});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");let g=f.rectangle(c,p,l,n,m),d=h.insert(()=>g,":first-child");e&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",e),o&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",o),v(t,d);let x=a?.padding??0;return t.width&&t.height&&(t.width+=x/2||0,t.height+=x/2||0),t.intersect=function(y){return S.rect(t,y)},h},"forkJoin");var Nr=u((i,t)=>{let{nodeStyles:s}=$(t);t.label="";let a=i.insert("g").attr("class",D(t)).attr("id",t.domId??t.id),{cssStyles:r}=t,o=Math.max(28,t.width??0),h=[{x:0,y:o/2},{x:o/2,y:0},{x:0,y:-o/2},{x:-o/2,y:0}],e=k.svg(a),l=N(t,{});t.look!=="handDrawn"&&(l.roughness=0,l.fillStyle="solid");let n=V(h),c=e.path(n,l),p=a.insert(()=>c,":first-child");return r&&t.look!=="handDrawn"&&p.selectAll("path").attr("style",r),s&&t.look!=="handDrawn"&&p.selectAll("path").attr("style",s),t.width=28,t.height=28,t.intersect=function(f){return S.polygon(t,h,f)},a},"choice");var vr=u(async(i,t,{config:{themeVariables:s}})=>{let{labelStyles:a,nodeStyles:r}=$(t);t.labelStyle=a;let{shapeSvg:o,bbox:h}=await C(i,t,D(t)),e=Math.max(h.width+(t.padding??0)*2,t?.width??0),l=Math.max(h.height+(t.padding??0)*2,t?.height??0),n=-e/2,c=-l/2,{cssStyles:p}=t;t.useHtmlLabels||(t.centerLabel=!0);let m=k.svg(o),g=N(t,{fill:s.noteBkgColor,stroke:s.noteBorderColor});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let d=m.rectangle(n,c,e,l,g),x=o.insert(()=>d,":first-child");return x.attr("class","basic label-container"),p&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",p),r&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",r),v(t,x),t.intersect=function(y){return S.rect(t,y)},o},"note");var te=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o}=await C(i,t,D(t)),h=o.height+t.padding,e=o.width+h/4+t.padding,l,{cssStyles:n}=t;if(t.look==="handDrawn"){let c=k.svg(r),p=N(t,{}),f=et(-e/2,-h/2,e,h,h/2),m=c.path(f,p);l=r.insert(()=>m,":first-child"),l.attr("class","basic label-container").attr("style",n)}else l=r.insert("rect",":first-child"),l.attr("class","basic label-container").attr("style",a).attr("rx",h/2).attr("ry",h/2).attr("x",-e/2).attr("y",-h/2).attr("width",e).attr("height",h);return v(t,l),t.intersect=function(c){return S.rect(t,c)},r},"stadium");var $r=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let r;t.cssClasses?r="node "+t.cssClasses:r="node default";let o=i.insert("g").attr("class",r).attr("id",t.domId||t.id),h=o.insert("g"),e=o.insert("g").attr("class","label").attr("style",a),l=t.description,n=t.label,c=e.node().appendChild(await rt(n,t.labelStyle,!0,!0)),p={width:0,height:0};if(Y(z()?.flowchart?.htmlLabels)){let E=c.children[0],W=Q(c);p=E.getBoundingClientRect(),W.attr("width",p.width),W.attr("height",p.height)}R.info("Text 2",l);let f=l||[],m=c.getBBox(),g=e.node().appendChild(await rt(f.join?f.join("<br/>"):f,t.labelStyle,!0,!0)),d=g.children[0],x=Q(g);p=d.getBoundingClientRect(),x.attr("width",p.width),x.attr("height",p.height);let y=(t.padding||0)/2;Q(g).attr("transform","translate( "+(p.width>m.width?0:(m.width-p.width)/2)+", "+(m.height+y+5)+")"),Q(c).attr("transform","translate( "+(p.width<m.width?0:-(m.width-p.width)/2)+", 0)"),p=e.node().getBBox(),e.attr("transform","translate("+-p.width/2+", "+(-p.height/2-y+3)+")");let b=p.width+(t.padding||0),w=p.height+(t.padding||0),P=-p.width/2-y,M=-p.height/2-y,A,B;if(t.look==="handDrawn"){let E=k.svg(o),W=N(t,{}),H=E.path(et(P,M,b,w,t.rx||0),W),_=E.line(-p.width/2-y,-p.height/2-y+m.height+y,p.width/2+y,-p.height/2-y+m.height+y,W);B=o.insert(()=>(R.debug("Rough node insert CXC",H),_),":first-child"),A=o.insert(()=>(R.debug("Rough node insert CXC",H),H),":first-child")}else A=h.insert("rect",":first-child"),B=h.insert("line"),A.attr("class","outer title-state").attr("style",a).attr("x",-p.width/2-y).attr("y",-p.height/2-y).attr("width",p.width+(t.padding||0)).attr("height",p.height+(t.padding||0)),B.attr("class","divider").attr("x1",-p.width/2-y).attr("x2",p.width/2+y).attr("y1",-p.height/2-y+m.height+y).attr("y2",-p.height/2-y+m.height+y);return v(t,A),t.intersect=function(E){return S.rect(t,E)},o},"rectWithTitle");function q(i,t,s,a){return i.insert("polygon",":first-child").attr("points",a.map(function(r){return r.x+","+r.y}).join(" ")).attr("class","label-container").attr("transform","translate("+-t/2+","+s/2+")")}u(q,"insertPolygonShape");var yt=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o}=await C(i,t,D(t)),h=(t?.padding||0)/2,e=o.width+t.padding,l=o.height+t.padding,n=-o.width/2-h,c=-o.height/2-h,p=[{x:0,y:0},{x:e,y:0},{x:e,y:-l},{x:0,y:-l},{x:0,y:0},{x:-8,y:0},{x:e+8,y:0},{x:e+8,y:-l},{x:-8,y:-l},{x:-8,y:0}];if(t.look==="handDrawn"){let f=k.svg(r),m=N(t,{}),g=f.rectangle(n-8,c,e+16,l,m),d=f.line(n,c,n,c+l,m),x=f.line(n+e,c,n+e,c+l,m);r.insert(()=>d,":first-child"),r.insert(()=>x,":first-child");let y=r.insert(()=>g,":first-child"),{cssStyles:b}=t;y.attr("class","basic label-container").attr("style",b),v(t,y)}else{let f=q(r,e,l,p);a&&f.attr("style",a),v(t,f)}return t.intersect=function(f){return S.polygon(t,p,f)},r},"subroutine");var Ms=u((i,t,s,a,r,o)=>[`M${i},${t+o}`,`a${r},${o} 0,0,0 ${s},0`,`a${r},${o} 0,0,0 ${-s},0`,`l0,${a}`,`a${r},${o} 0,0,0 ${s},0`,`l0,${-a}`].join(" "),"createCylinderPathD"),Ns=u((i,t,s,a,r,o)=>[`M${i},${t+o}`,`M${i+s},${t+o}`,`a${r},${o} 0,0,0 ${-s},0`,`l0,${a}`,`a${r},${o} 0,0,0 ${s},0`,`l0,${-a}`].join(" "),"createOuterCylinderPathD"),vs=u((i,t,s,a,r,o)=>[`M${i-s/2},${-a/2}`,`a${r},${o} 0,0,0 ${s},0`].join(" "),"createInnerCylinderPathD"),Ct=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o,label:h}=await C(i,t,D(t)),e=Math.max(o.width+t.padding,t.width??0),l=e/2,n=l/(2.5+e/50),c=Math.max(o.height+n+t.padding,t.height??0),p,{cssStyles:f}=t;if(t.look==="handDrawn"){let m=k.svg(r),g=Ns(0,0,e,c,l,n),d=vs(0,n,e,c,l,n),x=m.path(g,N(t,{})),y=m.path(d,N(t,{fill:"none"}));p=r.insert(()=>y,":first-child"),p=r.insert(()=>x,":first-child"),p.attr("class","basic label-container"),f&&p.attr("style",f)}else{let m=Ms(0,0,e,c,l,n);p=r.insert("path",":first-child").attr("d",m).attr("class","basic label-container").attr("style",f).attr("style",a)}return p.attr("label-offset-y",n),p.attr("transform",`translate(${-e/2}, ${-(c/2+n)})`),v(t,p),h.attr("transform",`translate(${-(o.width/2)-(o.x-(o.left??0))}, ${-(o.height/2)+(t.padding??0)/1.5-(o.y-(o.top??0))})`),t.intersect=function(m){let g=S.rect(t,m),d=g.x-(t.x??0);if(l!=0&&(Math.abs(d)<(t.width??0)/2||Math.abs(d)==(t.width??0)/2&&Math.abs(g.y-(t.y??0))>(t.height??0)/2-n)){let x=n*n*(1-d*d/(l*l));x>0&&(x=Math.sqrt(x)),x=n-x,m.y-(t.y??0)>0&&(x=-x),g.y+=x}return g},r},"cylinder");var Ee=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o,halfPadding:h}=await C(i,t,D(t)),e=o.width/2+h,l,{cssStyles:n}=t;if(t.look==="handDrawn"){let c=k.svg(r),p=N(t,{}),f=c.circle(0,0,e*2,p);l=r.insert(()=>f,":first-child"),l.attr("class","basic label-container").attr("style",n)}else l=r.insert("circle",":first-child").attr("class","basic label-container").attr("style",a).attr("r",e).attr("cx",0).attr("cy",0);return v(t,l),t.intersect=function(c){return R.info("Circle intersect",t,e,c),S.circle(t,e,c)},r},"circle");var ee=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o,halfPadding:h}=await C(i,t,D(t)),l=o.width/2+h+5,n=o.width/2+h,c,{cssStyles:p}=t;if(t.look==="handDrawn"){let f=k.svg(r),m=N(t,{roughness:.2,strokeWidth:2.5}),g=N(t,{roughness:.2,strokeWidth:1.5}),d=f.circle(0,0,l*2,m),x=f.circle(0,0,n*2,g);c=r.insert("g",":first-child"),c.attr("class",t.cssClasses).attr("style",p),c.node()?.appendChild(d),c.node()?.appendChild(x)}else{c=r.insert("g",":first-child");let f=c.insert("circle",":first-child"),m=c.insert("circle");c.attr("class","basic label-container").attr("style",a),f.attr("class","outer-circle").attr("style",a).attr("r",l).attr("cx",0).attr("cy",0),m.attr("class","inner-circle").attr("style",a).attr("r",n).attr("cx",0).attr("cy",0)}return v(t,c),t.intersect=function(f){return R.info("DoubleCircle intersect",t,l,f),S.circle(t,l,f)},r},"doublecircle");var Oe=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o,label:h}=await C(i,t,D(t)),e=Math.max(o.width+(t.padding??0),t?.width??0),l=Math.max(o.height+(t.padding??0),t?.height??0),n=-e/2,c=-l/2,p=c/2,f=[{x:n+p,y:c},{x:n,y:0},{x:n+p,y:-c},{x:-n,y:-c},{x:-n,y:c}],{cssStyles:m}=t,g=k.svg(r),d=N(t,{});t.look!=="handDrawn"&&(d.roughness=0,d.fillStyle="solid");let x=V(f),y=g.path(x,d),b=r.insert(()=>y,":first-child");return b.attr("class","basic label-container"),m&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",m),a&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",a),b.attr("transform",`translate(${-p/2},0)`),h.attr("transform",`translate(${-p/2-o.width/2-(o.x-(o.left??0))}, ${-(o.height/2)-(o.y-(o.top??0))})`),v(t,b),t.intersect=function(w){return S.polygon(t,f,w)},r},"rect_left_inv_arrow");var $s=u((i,t,s)=>[`M${i+s/2},${t}`,`L${i+s},${t-s/2}`,`L${i+s/2},${t-s}`,`L${i},${t-s/2}`,"Z"].join(" "),"createDecisionBoxPathD"),Dt=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o}=await C(i,t,D(t)),h=o.width+t.padding,e=o.height+t.padding,l=h+e,n=[{x:l/2,y:0},{x:l,y:-l/2},{x:l/2,y:-l},{x:0,y:-l/2}],c,{cssStyles:p}=t;if(t.look==="handDrawn"){let f=k.svg(r),m=N(t,{}),g=$s(0,0,l),d=f.path(g,m);c=r.insert(()=>d,":first-child").attr("transform",`translate(${-l/2}, ${l/2})`),p&&c.attr("style",p)}else c=q(r,l,l,n);return a&&c.attr("style",a),v(t,c),t.intersect=function(f){return R.debug(`APA12 Intersect called SPLIT
point:`,f,`
node:
`,t,`
res:`,S.polygon(t,n,f)),S.polygon(t,n,f)},r},"question");var Ps=u((i,t,s,a,r)=>[`M${i+r},${t}`,`L${i+s-r},${t}`,`L${i+s},${t-a/2}`,`L${i+s-r},${t-a}`,`L${i+r},${t-a}`,`L${i},${t-a/2}`,"Z"].join(" "),"createHexagonPathD"),re=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o}=await C(i,t,D(t)),h=4,e=o.height+t.padding,l=e/h,n=o.width+2*l+t.padding,c=[{x:l,y:0},{x:n-l,y:0},{x:n,y:-e/2},{x:n-l,y:-e},{x:l,y:-e},{x:0,y:-e/2}],p,{cssStyles:f}=t;if(t.look==="handDrawn"){let m=k.svg(r),g=N(t,{}),d=Ps(0,0,n,e,l),x=m.path(d,g);p=r.insert(()=>x,":first-child").attr("transform",`translate(${-n/2}, ${e/2})`),f&&p.attr("style",f)}else p=q(r,n,e,c);return a&&p.attr("style",a),t.width=n,t.height=e,v(t,p),t.intersect=function(m){return S.polygon(t,c,m)},r},"hexagon");async function Pr(i,t){let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o}=await C(i,t,D(t)),h=Math.max(o.width+t.padding,t?.width||0),e=Math.max(o.height+t.padding,t?.height||0),l=-h/2,n=-e/2,c=r.insert("rect",":first-child");return c.attr("class","text").attr("style",a).attr("rx",0).attr("ry",0).attr("x",l).attr("y",n).attr("width",h).attr("height",e),v(t,c),t.intersect=function(p){return S.rect(t,p)},r}u(Pr,"text");async function se(i,t){let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o}=await C(i,t,D(t)),h=o.height+t.padding,e=12,l=o.width+t.padding+e,n=0,c=l,p=-h,f=0,m=[{x:n+e,y:p},{x:c,y:p},{x:c,y:f},{x:n,y:f},{x:n,y:p+e},{x:n+e,y:p}],g,{cssStyles:d}=t;if(t.look==="handDrawn"){let x=k.svg(r),y=N(t,{}),b=V(m),w=x.path(b,y);g=r.insert(()=>w,":first-child").attr("transform",`translate(${-l/2}, ${h/2})`),d&&g.attr("style",d)}else g=q(r,l,h,m);return a&&g.attr("style",a),v(t,g),t.intersect=function(x){return S.polygon(t,m,x)},r}u(se,"card");var xt=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o,label:h}=await C(i,t,D(t)),e=t?.padding??0,l=Math.max(o.width+(t.padding??0)*2,t?.width??0),n=Math.max(o.height+(t.padding??0)*2,t?.height??0),c=-o.width/2-e,p=-o.height/2-e,{cssStyles:f}=t,m=k.svg(r),g=N(t,{});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let d=[{x:c,y:p},{x:c+l+8,y:p},{x:c+l+8,y:p+n},{x:c-8,y:p+n},{x:c-8,y:p},{x:c,y:p},{x:c,y:p+n}],x=m.polygon(d.map(b=>[b.x,b.y]),g),y=r.insert(()=>x,":first-child");return y.attr("class","basic label-container").attr("style",f),a&&t.look!=="handDrawn"&&y.selectAll("path").attr("style",a),f&&t.look!=="handDrawn"&&y.selectAll("path").attr("style",a),h.attr("transform",`translate(${-l/2+4+(t.padding??0)-(o.x-(o.left??0))},${-n/2+(t.padding??0)-(o.y-(o.top??0))})`),v(t,y),t.intersect=function(b){return S.rect(t,b)},r},"shadedProcess");var Cr=u((i,t)=>{let{labelStyles:s}=$(t);t.labelStyle=s;let a=D(t),r=a;a||(r="anchor");let o=i.insert("g").attr("class",r).attr("id",t.domId||t.id),h=1,{cssStyles:e}=t,l=k.svg(o),n=N(t,{fill:"black",stroke:"none",fillStyle:"solid"});t.look!=="handDrawn"&&(n.roughness=0);let c=l.circle(0,0,h*2,n),p=o.insert(()=>c,":first-child");return p.attr("class","anchor").attr("style",e),v(t,p),t.intersect=function(f){return R.info("Circle intersect",t,h,f),S.circle(t,h,f)},o},"anchor");var Lt=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o}=await C(i,t,D(t)),h=Math.max(o.width+(t.padding??0),t?.width??0),e=Math.max(o.height+(t.padding??0),t?.height??0),l=[{x:-3*e/6,y:0},{x:h,y:0},{x:h+3*e/6,y:-e},{x:0,y:-e}],n,{cssStyles:c}=t;if(t.look==="handDrawn"){let p=k.svg(r),f=N(t,{}),m=V(l),g=p.path(m,f);n=r.insert(()=>g,":first-child").attr("transform",`translate(${-h/2}, ${e/2})`),c&&n.attr("style",c)}else n=q(r,h,e,l);return a&&n.attr("style",a),t.width=h,t.height=e,v(t,n),t.intersect=function(p){return S.polygon(t,l,p)},r},"lean_right");var At=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o}=await C(i,t,D(t)),h=Math.max(o.width+(t.padding??0),t?.width??0),e=Math.max(o.height+(t.padding??0),t?.height??0),l=[{x:0,y:0},{x:h+3*e/6,y:0},{x:h,y:-e},{x:-(3*e)/6,y:-e}],n,{cssStyles:c}=t;if(t.look==="handDrawn"){let p=k.svg(r),f=N(t,{}),m=V(l),g=p.path(m,f);n=r.insert(()=>g,":first-child").attr("transform",`translate(${-h/2}, ${e/2})`),c&&n.attr("style",c)}else n=q(r,h,e,l);return a&&n.attr("style",a),t.width=h,t.height=e,v(t,n),t.intersect=function(p){return S.polygon(t,l,p)},r},"lean_left");var Rt=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o}=await C(i,t,D(t)),h=o.width+t.padding,e=o.height+t.padding,l=[{x:-3*e/6,y:0},{x:h+3*e/6,y:0},{x:h,y:-e},{x:0,y:-e}],n,{cssStyles:c}=t;if(t.look==="handDrawn"){let p=k.svg(r),f=N(t,{}),m=V(l),g=p.path(m,f);n=r.insert(()=>g,":first-child").attr("transform",`translate(${-h/2}, ${e/2})`),c&&n.attr("style",c)}else n=q(r,h,e,l);return a&&n.attr("style",a),t.width=h,t.height=e,v(t,n),t.intersect=function(p){return S.polygon(t,l,p)},r},"trapezoid");var bt=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o}=await C(i,t,D(t)),h=Math.max(o.width+(t.padding??0)*2,t?.width??0),e=Math.max(o.height+(t.padding??0)*2,t?.height??0),l=[{x:0,y:0},{x:h,y:0},{x:h+3*e/6,y:-e},{x:-3*e/6,y:-e}],n,{cssStyles:c}=t;if(t.look==="handDrawn"){let p=k.svg(r),f=N(t,{}),m=V(l),g=p.path(m,f);n=r.insert(()=>g,":first-child").attr("transform",`translate(${-h/2}, ${e/2})`),c&&n.attr("style",c)}else n=q(r,h,e,l);return a&&n.attr("style",a),t.width=h,t.height=e,v(t,n),t.intersect=function(p){return S.polygon(t,l,p)},r},"inv_trapezoid");var Dr=u(async(i,t)=>{let{shapeSvg:s,bbox:a,label:r}=await C(i,t,"label"),o=s.insert("rect",":first-child");return o.attr("width",.1).attr("height",.1),s.attr("class","label edgeLabel"),r.attr("transform",`translate(${-(a.width/2)-(a.x-(a.left??0))}, ${-(a.height/2)-(a.y-(a.top??0))})`),v(t,o),t.intersect=function(l){return S.rect(t,l)},s},"labelRect");var ae=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o,label:h}=await C(i,t,D(t)),e=Y(z().flowchart?.htmlLabels),l=o.width+(t.padding??0),n=l+o.height,c=l+o.height,p=[{x:0,y:0},{x:c,y:0},{x:c/2,y:-n}],{cssStyles:f}=t,m=k.svg(r),g=N(t,{});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let d=V(p),x=m.path(d,g),y=r.insert(()=>x,":first-child").attr("transform",`translate(${-n/2}, ${n/2})`);return f&&t.look!=="handDrawn"&&y.selectChildren("path").attr("style",f),a&&t.look!=="handDrawn"&&y.selectChildren("path").attr("style",a),t.width=l,t.height=n,v(t,y),h.attr("transform",`translate(${-o.width/2-(o.x-(o.left??0))}, ${n/2-(o.height+(t.padding??0)/(e?2:1)-(o.y-(o.top??0)))})`),t.intersect=function(b){return R.info("Triangle intersect",t,p,b),S.polygon(t,p,b)},r},"triangle");var Ge=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let r=80,o=50,{shapeSvg:h,bbox:e}=await C(i,t,D(t)),l=Math.max(r,e.width+(t.padding??0)*2,t?.width??0),n=Math.max(o,e.height+(t.padding??0)*2,t?.height??0),c=n/2,{cssStyles:p}=t,f=k.svg(h),m=N(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");let g=[{x:-l/2,y:-n/2},{x:l/2-c,y:-n/2},...Qt(-l/2+c,0,c,50,90,270),{x:l/2-c,y:n/2},{x:-l/2,y:n/2}],d=V(g),x=f.path(d,m),y=h.insert(()=>x,":first-child");return y.attr("class","basic label-container"),p&&t.look!=="handDrawn"&&y.selectChildren("path").attr("style",p),a&&t.look!=="handDrawn"&&y.selectChildren("path").attr("style",a),v(t,y),t.intersect=function(b){return R.info("Pill intersect",t,{radius:c,point:b}),S.polygon(t,g,b)},h},"halfRoundedRectangle");var oe=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o}=await C(i,t,D(t)),h=80,e=20,l=Math.max(h,(o.width+(t.padding??0)*2)*1.25,t?.width??0),n=Math.max(e,o.height+(t.padding??0)*2,t?.height??0),c=n/2,{cssStyles:p}=t,f=k.svg(r),m=N(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");let g=l,d=n,x=g-c,y=d/4,b=[{x,y:0},{x:y,y:0},{x:0,y:d/2},{x:y,y:d},{x,y:d},...Qt(-x,-d/2,c,50,270,90)],w=V(b),P=f.path(w,m),M=r.insert(()=>P,":first-child");return M.attr("class","basic label-container"),p&&t.look!=="handDrawn"&&M.selectChildren("path").attr("style",p),a&&t.look!=="handDrawn"&&M.selectChildren("path").attr("style",a),M.attr("transform",`translate(${-l/2}, ${-n/2})`),v(t,M),t.intersect=function(A){return S.polygon(t,b,A)},r},"curvedTrapezoid");var ne=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o,label:h}=await C(i,t,D(t)),e=Math.max(o.width+(t.padding??0)*2,t?.width??0),l=Math.max(o.height+(t.padding??0)*2,t?.height??0),n=-e/2,c=-l/2,{cssStyles:p}=t,f=k.svg(r),m=N(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");let g=[{x:n,y:c},{x:n,y:c+l},{x:n+e,y:c+l},{x:n+e,y:c-l/2}],d=V(g),x=f.path(d,m),y=r.insert(()=>x,":first-child");return y.attr("class","basic label-container"),p&&t.look!=="handDrawn"&&y.selectChildren("path").attr("style",p),a&&t.look!=="handDrawn"&&y.selectChildren("path").attr("style",a),y.attr("transform",`translate(0, ${l/4})`),h.attr("transform",`translate(${-e/2+(t.padding??0)-(o.x-(o.left??0))}, ${-l/4+(t.padding??0)-(o.y-(o.top??0))})`),v(t,y),t.intersect=function(b){return S.polygon(t,g,b)},r},"slopedRect");function Lr(i,t,s,a,r,o,h){let l=(i+s)/2,n=(t+a)/2,c=Math.atan2(a-t,s-i),p=(s-i)/2,f=(a-t)/2,m=p/r,g=f/o,d=Math.sqrt(m**2+g**2);if(d>1)throw new Error("The given radii are too small to create an arc between the points.");let x=Math.sqrt(1-d**2),y=l+x*o*Math.sin(c)*(h?-1:1),b=n-x*r*Math.cos(c)*(h?-1:1),w=Math.atan2((t-b)/o,(i-y)/r),M=Math.atan2((a-b)/o,(s-y)/r)-w;h&&M<0&&(M+=2*Math.PI),!h&&M>0&&(M-=2*Math.PI);let A=[];for(let B=0;B<20;B++){let E=B/19,W=w+E*M,H=y+r*Math.cos(W),_=b+o*Math.sin(W);A.push({x:H,y:_})}return A}u(Lr,"generateArcPoints");var ie=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o}=await C(i,t,D(t)),h=o.width+t.padding+20,e=o.height+t.padding,l=e/2,n=l/(2.5+e/50),{cssStyles:c}=t,p=[{x:h/2,y:-e/2},{x:-h/2,y:-e/2},...Lr(-h/2,-e/2,-h/2,e/2,n,l,!1),{x:h/2,y:e/2},...Lr(h/2,e/2,h/2,-e/2,n,l,!0)],f=k.svg(r),m=N(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");let g=V(p),d=f.path(g,m),x=r.insert(()=>d,":first-child");return x.attr("class","basic label-container"),c&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",c),a&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",a),x.attr("transform",`translate(${n/2}, 0)`),v(t,x),t.intersect=function(y){return S.polygon(t,p,y)},r},"bowTieRect");var Bt=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o,label:h}=await C(i,t,D(t)),e=o.width+t.padding,l=o.height+t.padding,n=l*.2,c=-e/2,p=-l/2-n/2,{cssStyles:f}=t,m=k.svg(r),g=N(t,{});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let d=[{x:c,y:p+n},{x:-c,y:p+n},{x:-c,y:-p},{x:c,y:-p},{x:c,y:p},{x:-c,y:p},{x:-c,y:p+n}],x=m.polygon(d.map(b=>[b.x,b.y]),g),y=r.insert(()=>x,":first-child");return y.attr("class","basic label-container"),f&&t.look!=="handDrawn"&&y.selectAll("path").attr("style",f),a&&t.look!=="handDrawn"&&y.selectAll("path").attr("style",a),h.attr("transform",`translate(${c+(t.padding??0)/2-(o.x-(o.left??0))}, ${p+n+(t.padding??0)/2-(o.y-(o.top??0))})`),v(t,y),t.intersect=function(b){return S.rect(t,b)},r},"dividedRectangle");function Cs(i){let t=Math.cos(Math.PI/4),s=Math.sin(Math.PI/4),a=i*2,r={x:a/2*t,y:a/2*s},o={x:-(a/2)*t,y:a/2*s},h={x:-(a/2)*t,y:-(a/2)*s},e={x:a/2*t,y:-(a/2)*s};return`M ${o.x},${o.y} L ${e.x},${e.y}
                   M ${r.x},${r.y} L ${h.x},${h.y}`}u(Cs,"createLine");var le=u((i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s,t.label="";let r=i.insert("g").attr("class",D(t)).attr("id",t.domId??t.id),o=Math.max(30,t?.width??0),{cssStyles:h}=t,e=k.svg(r),l=N(t,{});t.look!=="handDrawn"&&(l.roughness=0,l.fillStyle="solid");let n=e.circle(0,0,o*2,l),c=Cs(o),p=e.path(c,l),f=r.insert(()=>n,":first-child");return f.insert(()=>p),h&&t.look!=="handDrawn"&&f.selectAll("path").attr("style",h),a&&t.look!=="handDrawn"&&f.selectAll("path").attr("style",a),v(t,f),t.intersect=function(m){return R.info("crossedCircle intersect",t,{radius:o,point:m}),S.circle(t,o,m)},r},"crossedCircle");var He=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o}=await C(i,t,D(t)),h=100,e=50,l=Math.max(o.width+(t.padding??0)*2,t?.width??0),n=Math.max(o.height+(t.padding??0)*2,t?.height??0),c=l/n,p=l,f=n;p>f*c?f=p/c:p=f*c,p=Math.max(p,h),f=Math.max(f,e);let m=Math.min(f*.2,f/4),g=f+m*2,{cssStyles:d}=t,x=k.svg(r),y=N(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");let b=[{x:-p/2,y:g/2},...tt(-p/2,g/2,p/2,g/2,m,1),{x:p/2,y:-g/2},...tt(p/2,-g/2,-p/2,-g/2,m,-1)],w=V(b),P=x.path(w,y),M=r.insert(()=>P,":first-child");return M.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&M.selectAll("path").attr("style",d),a&&t.look!=="handDrawn"&&M.selectAll("path").attr("style",a),v(t,M),t.intersect=function(A){return S.polygon(t,b,A)},r},"waveRectangle");var Ds=u((i,t,s,a,r,o)=>`M${i},${t}
    a${r},${o} 0,0,1 0,${-a}
    l${s},0
    a${r},${o} 0,0,1 0,${a}
    M${s},${-a}
    a${r},${o} 0,0,0 0,${a}
    l${-s},0`,"createCylinderPathD"),Ls=u((i,t,s,a,r,o)=>[`M${i},${t}`,`M${i+s},${t}`,`a${r},${o} 0,0,0 0,${-a}`,`l${-s},0`,`a${r},${o} 0,0,0 0,${a}`,`l${s},0`].join(" "),"createOuterCylinderPathD"),As=u((i,t,s,a,r,o)=>[`M${i+s/2},${-a/2}`,`a${r},${o} 0,0,0 0,${a}`].join(" "),"createInnerCylinderPathD"),ce=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o,label:h,halfPadding:e}=await C(i,t,D(t)),l=t.look==="neo"?e*2:e,n=o.height+l,c=n/2,p=c/(2.5+n/50),f=o.width+p+l,{cssStyles:m}=t,g;if(t.look==="handDrawn"){let d=k.svg(r),x=Ls(0,0,f,n,p,c),y=As(0,0,f,n,p,c),b=d.path(x,N(t,{})),w=d.path(y,N(t,{fill:"none"}));g=r.insert(()=>w,":first-child"),g=r.insert(()=>b,":first-child"),g.attr("class","basic label-container"),m&&g.attr("style",m)}else{let d=Ds(0,0,f,n,p,c);g=r.insert("path",":first-child").attr("d",d).attr("class","basic label-container").attr("style",m).attr("style",a)}return g.attr("class","basic label-container"),m&&t.look!=="handDrawn"&&g.selectAll("path").attr("style",m),a&&t.look!=="handDrawn"&&g.selectAll("path").attr("style",a),g.attr("label-offset-x",p),g.attr("transform",`translate(${-f/2}, ${n/2} )`),h.attr("transform",`translate(${-(o.width/2)-p-(o.x-(o.left??0))}, ${-(o.height/2)-(o.y-(o.top??0))})`),v(t,g),t.intersect=function(d){let x=S.rect(t,d),y=x.y-(t.y??0);if(c!=0&&(Math.abs(y)<(t.height??0)/2||Math.abs(y)==(t.height??0)/2&&Math.abs(x.x-(t.x??0))>(t.width??0)/2-p)){let b=p*p*(1-y*y/(c*c));b!=0&&(b=Math.sqrt(b)),b=p-b,d.x-(t.x??0)>0&&(b=-b),x.x+=b}return x},r},"tiltedCylinder");var he=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o}=await C(i,t,D(t)),h=60,e=20,l=Math.max(h,o.width+(t.padding??0)*2,t?.width??0),n=Math.max(e,o.height+(t.padding??0)*2,t?.height??0),{cssStyles:c}=t,p=k.svg(r),f=N(t,{});t.look!=="handDrawn"&&(f.roughness=0,f.fillStyle="solid");let m=[{x:-l/2*.8,y:-n/2},{x:l/2*.8,y:-n/2},{x:l/2,y:-n/2*.6},{x:l/2,y:n/2},{x:-l/2,y:n/2},{x:-l/2,y:-n/2*.6}],g=V(m),d=p.path(g,f),x=r.insert(()=>d,":first-child");return x.attr("class","basic label-container"),c&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",c),a&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",a),v(t,x),t.intersect=function(y){return S.polygon(t,m,y)},r},"trapezoidalPentagon");var pe=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o,label:h}=await C(i,t,D(t)),e=o.width+(t.padding??0),l=e+o.height,n=e+o.height,c=[{x:0,y:-l},{x:n,y:-l},{x:n/2,y:0}],{cssStyles:p}=t,f=k.svg(r),m=N(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");let g=V(c),d=f.path(g,m),x=r.insert(()=>d,":first-child").attr("transform",`translate(${-l/2}, ${l/2})`);return p&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",p),a&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",a),t.width=e,t.height=l,v(t,x),h.attr("transform",`translate(${-o.width/2-(o.x-(o.left??0))}, ${-l/2+(t.padding??0)/2+(o.y-(o.top??0))})`),t.intersect=function(y){return R.info("Triangle intersect",t,c,y),S.polygon(t,c,y)},r},"flippedTriangle");var Ve=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.label="",t.labelStyle=s;let{shapeSvg:r}=await C(i,t,D(t)),o=Math.max(30,t?.width??0),h=Math.max(30,t?.height??0),{cssStyles:e}=t,l=k.svg(r),n=N(t,{});t.look!=="handDrawn"&&(n.roughness=0,n.fillStyle="solid");let c=[{x:0,y:0},{x:o,y:0},{x:0,y:h},{x:o,y:h}],p=V(c),f=l.path(p,n),m=r.insert(()=>f,":first-child");return m.attr("class","basic label-container"),e&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",e),a&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",a),m.attr("transform",`translate(${-o/2}, ${-h/2})`),v(t,m),t.intersect=function(g){return R.info("Pill intersect",t,{points:c}),S.polygon(t,c,g)},r},"hourglass");var Et=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o}=await C(i,t,D(t)),h=Math.max(o.width+(t.padding??0)*2,t?.width??0),e=Math.max(o.height+(t.padding??0)*2,t?.height??0),l=-h/2,n=-e/2,c=.2*e,p=.2*e,{cssStyles:f}=t,m=k.svg(r),g=N(t,{}),d=[{x:l-c/2,y:n},{x:l+h+c/2,y:n},{x:l+h+c/2,y:n+e},{x:l-c/2,y:n+e}],x=[{x:l+h-c/2,y:n+e},{x:l+h+c/2,y:n+e},{x:l+h+c/2,y:n+e-p}];t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let y=V(d),b=m.path(y,g),w=V(x),P=m.path(w,{...g,fillStyle:"solid"}),M=r.insert(()=>P,":first-child");return M.insert(()=>b,":first-child"),M.attr("class","basic label-container"),f&&t.look!=="handDrawn"&&M.selectAll("path").attr("style",f),a&&t.look!=="handDrawn"&&M.selectAll("path").attr("style",a),v(t,M),t.intersect=function(A){return S.polygon(t,d,A)},r},"taggedRect");var Ot=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o,label:h}=await C(i,t,D(t)),e=Math.max(o.width+(t.padding??0)*2,t?.width??0),l=Math.max(o.height+(t.padding??0)*2,t?.height??0),n=5,c=-e/2,p=-l/2,{cssStyles:f}=t,m=k.svg(r),g=N(t,{}),d=[{x:c-n,y:p+n},{x:c-n,y:p+l+n},{x:c+e-n,y:p+l+n},{x:c+e-n,y:p+l},{x:c+e,y:p+l},{x:c+e,y:p+l-n},{x:c+e+n,y:p+l-n},{x:c+e+n,y:p-n},{x:c+n,y:p-n},{x:c+n,y:p},{x:c,y:p},{x:c,y:p+n}],x=[{x:c,y:p+n},{x:c+e-n,y:p+n},{x:c+e-n,y:p+l},{x:c+e,y:p+l},{x:c+e,y:p},{x:c,y:p}];t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let y=V(d),b=m.path(y,g),w=V(x),P=m.path(w,{...g,fill:"none"}),M=r.insert(()=>P,":first-child");return M.insert(()=>b,":first-child"),M.attr("class","basic label-container"),f&&t.look!=="handDrawn"&&M.selectAll("path").attr("style",f),a&&t.look!=="handDrawn"&&M.selectAll("path").attr("style",a),h.attr("transform",`translate(${-(o.width/2)-n-(o.x-(o.left??0))}, ${-(o.height/2)+n-(o.y-(o.top??0))})`),v(t,M),t.intersect=function(A){return S.polygon(t,d,A)},r},"multiRect");var Rs=u((i,t,s,a,r,o,h)=>[`M${i},${t+o}`,`a${r},${o} 0,0,0 ${s},0`,`a${r},${o} 0,0,0 ${-s},0`,`l0,${a}`,`a${r},${o} 0,0,0 ${s},0`,`l0,${-a}`,`M${i},${t+o+h}`,`a${r},${o} 0,0,0 ${s},0`].join(" "),"createCylinderPathD"),Bs=u((i,t,s,a,r,o,h)=>[`M${i},${t+o}`,`M${i+s},${t+o}`,`a${r},${o} 0,0,0 ${-s},0`,`l0,${a}`,`a${r},${o} 0,0,0 ${s},0`,`l0,${-a}`,`M${i},${t+o+h}`,`a${r},${o} 0,0,0 ${s},0`].join(" "),"createOuterCylinderPathD"),Es=u((i,t,s,a,r,o)=>[`M${i-s/2},${-a/2}`,`a${r},${o} 0,0,0 ${s},0`].join(" "),"createInnerCylinderPathD"),fe=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o,label:h}=await C(i,t,D(t)),e=Math.max(o.width+(t.padding??0),t.width??0),l=e/2,n=l/(2.5+e/50),c=Math.max(o.height+n+(t.padding??0),t.height??0),p=c*.1,f,{cssStyles:m}=t;if(t.look==="handDrawn"){let g=k.svg(r),d=Bs(0,0,e,c,l,n,p),x=Es(0,n,e,c,l,n),y=N(t,{}),b=g.path(d,y),w=g.path(x,y);r.insert(()=>w,":first-child").attr("class","line"),f=r.insert(()=>b,":first-child"),f.attr("class","basic label-container"),m&&f.attr("style",m)}else{let g=Rs(0,0,e,c,l,n,p);f=r.insert("path",":first-child").attr("d",g).attr("class","basic label-container").attr("style",m).attr("style",a)}return f.attr("label-offset-y",n),f.attr("transform",`translate(${-e/2}, ${-(c/2+n)})`),v(t,f),h.attr("transform",`translate(${-(o.width/2)-(o.x-(o.left??0))}, ${-(o.height/2)+n-(o.y-(o.top??0))})`),t.intersect=function(g){let d=S.rect(t,g),x=d.x-(t.x??0);if(l!=0&&(Math.abs(x)<(t.width??0)/2||Math.abs(x)==(t.width??0)/2&&Math.abs(d.y-(t.y??0))>(t.height??0)/2-n)){let y=n*n*(1-x*x/(l*l));y>0&&(y=Math.sqrt(y)),y=n-y,g.y-(t.y??0)>0&&(y=-y),d.y+=y}return d},r},"linedCylinder");var We=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o,label:h}=await C(i,t,D(t)),e=Math.max(o.width+(t.padding??0)*2,t?.width??0),l=Math.max(o.height+(t.padding??0)*2,t?.height??0),n=l/8,c=l+n,{cssStyles:p}=t,m=70-e,g=m>0?m/2:0,d=k.svg(r),x=N(t,{});t.look!=="handDrawn"&&(x.roughness=0,x.fillStyle="solid");let y=[{x:-e/2-g,y:c/2},...tt(-e/2-g,c/2,e/2+g,c/2,n,.8),{x:e/2+g,y:-c/2},{x:-e/2-g,y:-c/2}],b=V(y),w=d.path(b,x),P=r.insert(()=>w,":first-child");return P.attr("class","basic label-container"),p&&t.look!=="handDrawn"&&P.selectAll("path").attr("style",p),a&&t.look!=="handDrawn"&&P.selectAll("path").attr("style",a),P.attr("transform",`translate(0,${-n/2})`),h.attr("transform",`translate(${-e/2+(t.padding??0)-(o.x-(o.left??0))},${-l/2+(t.padding??0)-n-(o.y-(o.top??0))})`),v(t,P),t.intersect=function(M){return S.polygon(t,y,M)},r},"waveEdgedRectangle");var me=u((i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.label="",t.labelStyle=s;let r=i.insert("g").attr("class",D(t)).attr("id",t.domId??t.id),{cssStyles:o}=t,h=Math.max(35,t?.width??0),e=Math.max(35,t?.height??0),l=7,n=[{x:h,y:0},{x:0,y:e+l/2},{x:h-2*l,y:e+l/2},{x:0,y:2*e},{x:h,y:e-l/2},{x:2*l,y:e-l/2}],c=k.svg(r),p=N(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let f=V(n),m=c.path(f,p),g=r.insert(()=>m,":first-child");return o&&t.look!=="handDrawn"&&g.selectAll("path").attr("style",o),a&&t.look!=="handDrawn"&&g.selectAll("path").attr("style",a),g.attr("transform",`translate(-${h/2},${-e})`),v(t,g),t.intersect=function(d){return R.info("lightningBolt intersect",t,d),S.polygon(t,n,d)},r},"lightningBolt");var ge=u((i,t,{config:{themeVariables:s}})=>{let{labelStyles:a,nodeStyles:r}=$(t);t.label="",t.labelStyle=a;let o=i.insert("g").attr("class",D(t)).attr("id",t.domId??t.id),h=7,{cssStyles:e}=t,l=k.svg(o),{nodeBorder:n}=s,c=N(t,{fillStyle:"solid"});t.look!=="handDrawn"&&(c.roughness=0);let p=l.circle(0,0,h*2,c),f=o.insert(()=>p,":first-child");return f.selectAll("path").attr("style",`fill: ${n} !important;`),e&&e.length>0&&t.look!=="handDrawn"&&f.selectAll("path").attr("style",e),r&&t.look!=="handDrawn"&&f.selectAll("path").attr("style",r),v(t,f),t.intersect=function(m){return R.info("filledCircle intersect",t,{radius:h,point:m}),S.circle(t,h,m)},o},"filledCircle");var Gt=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o,label:h}=await C(i,t,D(t)),e=Math.max(o.width+(t.padding??0)*2,t?.width??0),l=Math.max(o.height+(t.padding??0)*2,t?.height??0),n=l/4,c=l+n,p=-e/2,f=-c/2,m=5,{cssStyles:g}=t,d=tt(p-m,f+c+m,p+e-m,f+c+m,n,.8),x=d?.[d.length-1],y=[{x:p-m,y:f+m},{x:p-m,y:f+c+m},...d,{x:p+e-m,y:x.y-m},{x:p+e,y:x.y-m},{x:p+e,y:x.y-2*m},{x:p+e+m,y:x.y-2*m},{x:p+e+m,y:f-m},{x:p+m,y:f-m},{x:p+m,y:f},{x:p,y:f},{x:p,y:f+m}],b=[{x:p,y:f+m},{x:p+e-m,y:f+m},{x:p+e-m,y:x.y-m},{x:p+e,y:x.y-m},{x:p+e,y:f},{x:p,y:f}],w=k.svg(r),P=N(t,{});t.look!=="handDrawn"&&(P.roughness=0,P.fillStyle="solid");let M=V(y),A=w.path(M,P),B=V(b),E=w.path(B,P),W=r.insert(()=>A,":first-child");return W.insert(()=>E),W.attr("class","basic label-container"),g&&t.look!=="handDrawn"&&W.selectAll("path").attr("style",g),a&&t.look!=="handDrawn"&&W.selectAll("path").attr("style",a),W.attr("transform",`translate(0,${-n/2})`),h.attr("transform",`translate(${-(o.width/2)-m-(o.x-(o.left??0))}, ${-(o.height/2)+m-n/2-(o.y-(o.top??0))})`),v(t,W),t.intersect=function(H){return S.polygon(t,y,H)},r},"multiWaveEdgedRectangle");var ue=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o,label:h}=await C(i,t,D(t)),e=Math.max(o.width+(t.padding??0)*2,t?.width??0),l=Math.max(o.height+(t.padding??0)*2,t?.height??0),n=5,c=-e/2,p=-l/2,{cssStyles:f}=t,m=k.svg(r),g=N(t,{}),d=[{x:c-n,y:p-n},{x:c-n,y:p+l},{x:c+e,y:p+l},{x:c+e,y:p-n}],x=`M${c-n},${p-n} L${c+e},${p-n} L${c+e},${p+l} L${c-n},${p+l} L${c-n},${p-n}
                M${c-n},${p} L${c+e},${p}
                M${c},${p-n} L${c},${p+l}`;t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let y=m.path(x,g),b=r.insert(()=>y,":first-child");return b.attr("transform",`translate(${n/2}, ${n/2})`),b.attr("class","basic label-container"),f&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",f),a&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",a),h.attr("transform",`translate(${-(o.width/2)+n/2-(o.x-(o.left??0))}, ${-(o.height/2)+n/2-(o.y-(o.top??0))})`),v(t,b),t.intersect=function(w){return S.polygon(t,d,w)},r},"windowPane");var Te=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o,label:h}=await C(i,t,D(t)),e=Math.max(o.width+(t.padding??0)*2,t?.width??0),l=Math.max(o.height+(t.padding??0)*2,t?.height??0),n=l/4,c=l+n,{cssStyles:p}=t,f=k.svg(r),m=N(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");let g=[{x:-e/2-e/2*.1,y:-c/2},{x:-e/2-e/2*.1,y:c/2},...tt(-e/2-e/2*.1,c/2,e/2+e/2*.1,c/2,n,.8),{x:e/2+e/2*.1,y:-c/2},{x:-e/2-e/2*.1,y:-c/2},{x:-e/2,y:-c/2},{x:-e/2,y:c/2*1.1},{x:-e/2,y:-c/2}],d=f.polygon(g.map(y=>[y.x,y.y]),m),x=r.insert(()=>d,":first-child");return x.attr("class","basic label-container"),p&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",p),a&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",a),x.attr("transform",`translate(0,${-n/2})`),h.attr("transform",`translate(${-e/2+(t.padding??0)+e/2*.1/2-(o.x-(o.left??0))},${-l/2+(t.padding??0)-n/2-(o.y-(o.top??0))})`),v(t,x),t.intersect=function(y){return S.polygon(t,g,y)},r},"linedWaveEdgedRect");var je=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o,label:h}=await C(i,t,D(t)),e=Math.max(o.width+(t.padding??0)*2,t?.width??0),l=Math.max(o.height+(t.padding??0)*2,t?.height??0),n=l/4,c=.2*e,p=.2*l,f=l+n,{cssStyles:m}=t,g=k.svg(r),d=N(t,{});t.look!=="handDrawn"&&(d.roughness=0,d.fillStyle="solid");let x=[{x:-e/2-e/2*.1,y:f/2},...tt(-e/2-e/2*.1,f/2,e/2+e/2*.1,f/2,n,.8),{x:e/2+e/2*.1,y:-f/2},{x:-e/2-e/2*.1,y:-f/2}],y=-e/2+e/2*.1,b=-f/2-p*.4,w=[{x:y+e-c,y:(b+l)*1.4},{x:y+e,y:b+l-p},{x:y+e,y:(b+l)*.9},...tt(y+e,(b+l)*1.3,y+e-c,(b+l)*1.5,-l*.03,.5)],P=V(x),M=g.path(P,d),A=V(w),B=g.path(A,{...d,fillStyle:"solid"}),E=r.insert(()=>B,":first-child");return E.insert(()=>M,":first-child"),E.attr("class","basic label-container"),m&&t.look!=="handDrawn"&&E.selectAll("path").attr("style",m),a&&t.look!=="handDrawn"&&E.selectAll("path").attr("style",a),E.attr("transform",`translate(0,${-n/2})`),h.attr("transform",`translate(${-e/2+(t.padding??0)-(o.x-(o.left??0))},${-l/2+(t.padding??0)-n/2-(o.y-(o.top??0))})`),v(t,E),t.intersect=function(W){return S.polygon(t,x,W)},r},"taggedWaveEdgedRectangle");function it(i,t,s,a=100,r=0,o=180){let h=[],e=r*Math.PI/180,c=(o*Math.PI/180-e)/(a-1);for(let p=0;p<a;p++){let f=e+p*c,m=i+s*Math.cos(f),g=t+s*Math.sin(f);h.push({x:-m,y:-g})}return h}u(it,"generateCirclePoints");var de=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o,label:h}=await C(i,t,D(t)),e=o.width+(t.padding??0),l=o.height+(t.padding??0),n=Math.max(5,l*.1),{cssStyles:c}=t,p=[...it(e/2,-l/2,n,30,-90,0),{x:-e/2-n,y:n},...it(e/2+n*2,-n,n,20,-180,-270),...it(e/2+n*2,n,n,20,-90,-180),{x:-e/2-n,y:-l/2},...it(e/2,l/2,n,20,0,90)],f=[{x:e/2,y:-l/2-n},{x:-e/2,y:-l/2-n},...it(e/2,-l/2,n,20,-90,0),{x:-e/2-n,y:-n},...it(e/2+e*.1,-n,n,20,-180,-270),...it(e/2+e*.1,n,n,20,-90,-180),{x:-e/2-n,y:l/2},...it(e/2,l/2,n,20,0,90),{x:-e/2,y:l/2+n},{x:e/2,y:l/2+n}],m=k.svg(r),g=N(t,{fill:"none"});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let x=V(p).replace("Z",""),y=m.path(x,g),b=V(f),w=m.path(b,{...g}),P=r.insert("g",":first-child");return P.insert(()=>w,":first-child").attr("stroke-opacity",0),P.insert(()=>y,":first-child"),P.attr("class","text"),c&&t.look!=="handDrawn"&&P.selectAll("path").attr("style",c),a&&t.look!=="handDrawn"&&P.selectAll("path").attr("style",a),P.attr("transform",`translate(${n}, 0)`),h.attr("transform",`translate(${-e/2+n-(o.x-(o.left??0))},${-l/2+(t.padding??0)/2-(o.y-(o.top??0))})`),v(t,P),t.intersect=function(M){return S.polygon(t,f,M)},r},"curlyBraceLeft");function lt(i,t,s,a=100,r=0,o=180){let h=[],e=r*Math.PI/180,c=(o*Math.PI/180-e)/(a-1);for(let p=0;p<a;p++){let f=e+p*c,m=i+s*Math.cos(f),g=t+s*Math.sin(f);h.push({x:m,y:g})}return h}u(lt,"generateCirclePoints");var Ar=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o,label:h}=await C(i,t,D(t)),e=o.width+(t.padding??0),l=o.height+(t.padding??0),n=Math.max(5,l*.1),{cssStyles:c}=t,p=[...lt(e/2,-l/2,n,20,-90,0),{x:e/2+n,y:-n},...lt(e/2+n*2,-n,n,20,-180,-270),...lt(e/2+n*2,n,n,20,-90,-180),{x:e/2+n,y:l/2},...lt(e/2,l/2,n,20,0,90)],f=[{x:-e/2,y:-l/2-n},{x:e/2,y:-l/2-n},...lt(e/2,-l/2,n,20,-90,0),{x:e/2+n,y:-n},...lt(e/2+n*2,-n,n,20,-180,-270),...lt(e/2+n*2,n,n,20,-90,-180),{x:e/2+n,y:l/2},...lt(e/2,l/2,n,20,0,90),{x:e/2,y:l/2+n},{x:-e/2,y:l/2+n}],m=k.svg(r),g=N(t,{fill:"none"});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let x=V(p).replace("Z",""),y=m.path(x,g),b=V(f),w=m.path(b,{...g}),P=r.insert("g",":first-child");return P.insert(()=>w,":first-child").attr("stroke-opacity",0),P.insert(()=>y,":first-child"),P.attr("class","text"),c&&t.look!=="handDrawn"&&P.selectAll("path").attr("style",c),a&&t.look!=="handDrawn"&&P.selectAll("path").attr("style",a),P.attr("transform",`translate(${-n}, 0)`),h.attr("transform",`translate(${-e/2+(t.padding??0)/2-(o.x-(o.left??0))},${-l/2+(t.padding??0)/2-(o.y-(o.top??0))})`),v(t,P),t.intersect=function(M){return S.polygon(t,f,M)},r},"curlyBraceRight");function Z(i,t,s,a=100,r=0,o=180){let h=[],e=r*Math.PI/180,c=(o*Math.PI/180-e)/(a-1);for(let p=0;p<a;p++){let f=e+p*c,m=i+s*Math.cos(f),g=t+s*Math.sin(f);h.push({x:-m,y:-g})}return h}u(Z,"generateCirclePoints");var Rr=u(async(i,t)=>{let{labelStyles:s,nodeStyles:a}=$(t);t.labelStyle=s;let{shapeSvg:r,bbox:o,label:h}=await C(i,t,D(t)),e=o.width+(t.padding??0),l=o.height+(t.padding??0),n=Math.max(5,l*.1),{cssStyles:c}=t,p=[...Z(e/2,-l/2,n,30,-90,0),{x:-e/2-n,y:n},...Z(e/2+n*2,-n,n,20,-180,-270),...Z(e/2+n*2,n,n,20,-90,-180),{x:-e/2-n,y:-l/2},...Z(e/2,l/2,n,20,0,90)],f=[...Z(-e/2+n+n/2,-l/2,n,20,-90,-180),{x:e/2-n/2,y:n},...Z(-e/2-n/2,-n,n,20,0,90),...Z(-e/2-n/2,n,n,20,-90,0),{x:e/2-n/2,y:-n},...Z(-e/2+n+n/2,l/2,n,30,-180,-270)],m=[{x:e/2,y:-l/2-n},{x:-e/2,y:-l/2-n},...Z(e/2,-l/2,n,20,-90,0),{x:-e/2-n,y:-n},...Z(e/2+n*2,-n,n,20,-180,-270),...Z(e/2+n*2,n,n,20,-90,-180),{x:-e/2-n,y:l/2},...Z(e/2,l/2,n,20,0,90),{x:-e/2,y:l/2+n},{x:e/2-n-n/2,y:l/2+n},...Z(-e/2+n+n/2,-l/2,n,20,-90,-180),{x:e/2-n/2,y:n},...Z(-e/2-n/2,-n,n,20,0,90),...Z(-e/2-n/2,n,n,20,-90,0),{x:e/2-n/2,y:-n},...Z(-e/2+n+n/2,l/2,n,30,-180,-270)],g=k.svg(r),d=N(t,{fill:"none"});t.look!=="handDrawn"&&(d.roughness=0,d.fillStyle="solid");let y=V(p).replace("Z",""),b=g.path(y,d),P=V(f).replace("Z",""),M=g.path(P,d),A=V(m),B=g.path(A,{...d}),E=r.insert("g",":first-child");return E.insert(()=>B,":first-child").attr("stroke-opacity",0),E.insert(()=>b,":first-child"),E.insert(()=>M,":first-child"),E.attr("class","text"),c&&t.look!=="handDrawn"&&E.selectAll("path").attr("style",c),a&&t.look!=="handDrawn"&&E.selectAll("path").attr("style",a),E.attr("transform",`translate(${n-n/4}, 0)`),h.attr("transform",`translate(${-e/2+(t.padding??0)/2-(o.x-(o.left??0))},${-l/2+(t.padding??0)/2-(o.y-(o.top??0))})`),v(t,E),t.intersect=function(W){return S.polygon(t,m,W)},r},"curlyBraces");var Br=u(async(i,t,{config:{themeVariables:s,flowchart:a}})=>{let{labelStyles:r}=$(t);t.labelStyle=r;let o=t.assetHeight??48,h=t.assetWidth??48,e=Math.max(o,h),l=a?.wrappingWidth;t.width=Math.max(e,l??0);let{shapeSvg:n,bbox:c,halfPadding:p,label:f}=await C(i,t,"icon-shape default"),m=t.pos==="t",g=e+p*2,d=e+p*2,{nodeBorder:x,mainBkg:y}=s,{stylesMap:b}=st(t),w=-d/2,P=-g/2,M=t.label?8:0,A=k.svg(n),B=N(t,{stroke:b.get("fill")||y});t.look!=="handDrawn"&&(B.roughness=0,B.fillStyle="solid");let E=A.rectangle(w,P,d,g,B),W=Math.max(d,c.width),H=g+c.height+M,_=A.rectangle(-W/2,-H/2,W,H,{...B,fill:"transparent",stroke:"none"}),F=n.insert(()=>E,":first-child"),G=n.insert(()=>_);if(t.icon){let O=n.append("g");O.html(`<g>${await ot(t.icon,{height:e,width:e,fallbackPrefix:""})}</g>`);let L=O.node().getBBox(),j=L.width,T=L.height,U=L.x,at=L.y;O.attr("transform",`translate(${-j/2-U},${m?c.height/2+M/2-T/2-at:-c.height/2-M/2-T/2-at})`),O.selectAll("path").attr("fill",b.get("stroke")??x)}return f.attr("transform",`translate(${-c.width/2-(c.x-(c.left??0))},${m?-H/2:H/2-c.height})`),F.attr("transform",`translate(0,${m?c.height/2+M/2:-c.height/2-M/2})`),v(t,G),t.intersect=function(O){if(R.info("iconSquare intersect",t,O),!t.label)return S.rect(t,O);let L=t.x??0,j=t.y??0,T=t.height??0,U=[];return m?U=[{x:L-c.width/2,y:j-T/2},{x:L+c.width/2,y:j-T/2},{x:L+c.width/2,y:j-T/2+c.height+M},{x:L+d/2,y:j-T/2+c.height+M},{x:L+d/2,y:j+T/2},{x:L-d/2,y:j+T/2},{x:L-d/2,y:j-T/2+c.height+M},{x:L-c.width/2,y:j-T/2+c.height+M}]:U=[{x:L-d/2,y:j-T/2},{x:L+d/2,y:j-T/2},{x:L+d/2,y:j-T/2+g},{x:L+c.width/2,y:j-T/2+g},{x:L+c.width/2/2,y:j+T/2},{x:L-c.width/2,y:j+T/2},{x:L-c.width/2,y:j-T/2+g},{x:L-d/2,y:j-T/2+g}],S.polygon(t,U,O)},n},"iconSquare");var Er=u(async(i,t,{config:{themeVariables:s,flowchart:a}})=>{let{labelStyles:r}=$(t);t.labelStyle=r;let o=t.assetHeight??48,h=t.assetWidth??48,e=Math.max(o,h),l=a?.wrappingWidth;t.width=Math.max(e,l??0);let{shapeSvg:n,bbox:c,label:p}=await C(i,t,"icon-shape default"),f=20,m=t.label?8:0,g=t.pos==="t",{nodeBorder:d,mainBkg:x}=s,{stylesMap:y}=st(t),b=k.svg(n),w=N(t,{stroke:y.get("fill")||x});t.look!=="handDrawn"&&(w.roughness=0,w.fillStyle="solid");let P=n.append("g");t.icon&&P.html(`<g>${await ot(t.icon,{height:e,width:e,fallbackPrefix:""})}</g>`);let M=P.node().getBBox(),A=M.width,B=M.height,E=M.x,W=M.y,H=Math.max(A,B)*Math.SQRT2+f*2,_=b.circle(0,0,H,w),F=Math.max(H,c.width),G=H+c.height+m,O=b.rectangle(-F/2,-G/2,F,G,{...w,fill:"transparent",stroke:"none"}),L=n.insert(()=>_,":first-child"),j=n.insert(()=>O);return P.attr("transform",`translate(${-A/2-E},${g?c.height/2+m/2-B/2-W:-c.height/2-m/2-B/2-W})`),P.selectAll("path").attr("fill",y.get("stroke")||d),p.attr("transform",`translate(${-c.width/2-(c.x-(c.left??0))},${g?-G/2:G/2-c.height})`),L.attr("transform",`translate(0,${g?c.height/2+m/2:-c.height/2-m/2})`),v(t,j),t.intersect=function(T){return R.info("iconSquare intersect",t,T),S.rect(t,T)},n},"iconCircle");var Or=u(async(i,t,{config:{themeVariables:s,flowchart:a}})=>{let{labelStyles:r}=$(t);t.labelStyle=r;let o=t.assetHeight??48,h=t.assetWidth??48,e=Math.max(o,h),l=a?.wrappingWidth;t.width=Math.max(e,l??0);let{shapeSvg:n,bbox:c,label:p}=await C(i,t,"icon-shape default"),f=t.pos==="t",m=e,g=e,{nodeBorder:d}=s,{stylesMap:x}=st(t),y=-g/2,b=-m/2,w=t.label?8:0,P=k.svg(n),M=N(t,{stroke:"none",fill:"none"});t.look!=="handDrawn"&&(M.roughness=0,M.fillStyle="solid");let A=P.rectangle(y,b,g,m,M),B=Math.max(g,c.width),E=m+c.height+w,W=P.rectangle(-B/2,-E/2,B,E,{...M,fill:"transparent",stroke:"none"}),H=n.insert(()=>A,":first-child"),_=n.insert(()=>W);if(t.icon){let F=n.append("g");F.html(`<g>${await ot(t.icon,{height:e,width:e,fallbackPrefix:""})}</g>`);let G=F.node().getBBox(),O=G.width,L=G.height,j=G.x,T=G.y;F.attr("transform",`translate(${-O/2-j},${f?c.height/2+w/2-L/2-T:-c.height/2-w/2-L/2-T})`),F.selectAll("path").attr("fill",x.get("stroke")||d)}return p.attr("transform",`translate(${-c.width/2-(c.x-(c.left??0))},${f?-E/2:E/2-c.height})`),H.attr("transform",`translate(0,${f?c.height/2+w/2:-c.height/2-w/2})`),v(t,_),t.intersect=function(F){if(R.info("iconSquare intersect",t,F),!t.label)return S.rect(t,F);let G=t.x??0,O=t.y??0,L=t.height??0,j=[];return f?j=[{x:G-c.width/2,y:O-L/2},{x:G+c.width/2,y:O-L/2},{x:G+c.width/2,y:O-L/2+c.height+w},{x:G+g/2,y:O-L/2+c.height+w},{x:G+g/2,y:O+L/2},{x:G-g/2,y:O+L/2},{x:G-g/2,y:O-L/2+c.height+w},{x:G-c.width/2,y:O-L/2+c.height+w}]:j=[{x:G-g/2,y:O-L/2},{x:G+g/2,y:O-L/2},{x:G+g/2,y:O-L/2+m},{x:G+c.width/2,y:O-L/2+m},{x:G+c.width/2/2,y:O+L/2},{x:G-c.width/2,y:O+L/2},{x:G-c.width/2,y:O-L/2+m},{x:G-g/2,y:O-L/2+m}],S.polygon(t,j,F)},n},"icon");var Gr=u(async(i,t,{config:{flowchart:s}})=>{let a=new Image;a.src=t?.img??"",await a.decode();let r=Number(a.naturalWidth.toString().replace("px","")),o=Number(a.naturalHeight.toString().replace("px",""));t.imageAspectRatio=r/o;let{labelStyles:h}=$(t);t.labelStyle=h;let e=s?.wrappingWidth;t.defaultWidth=s?.wrappingWidth;let l=Math.max(t.label?e??0:0,t?.assetWidth??r),n=t.constraint==="on"&&t?.assetHeight?t.assetHeight*t.imageAspectRatio:l,c=t.constraint==="on"?n/t.imageAspectRatio:t?.assetHeight??o;t.width=Math.max(n,e??0);let{shapeSvg:p,bbox:f,label:m}=await C(i,t,"image-shape default"),g=t.pos==="t",d=-n/2,x=-c/2,y=t.label?8:0,b=k.svg(p),w=N(t,{});t.look!=="handDrawn"&&(w.roughness=0,w.fillStyle="solid");let P=b.rectangle(d,x,n,c,w),M=Math.max(n,f.width),A=c+f.height+y,B=b.rectangle(-M/2,-A/2,M,A,{...w,fill:"none",stroke:"none"}),E=p.insert(()=>P,":first-child"),W=p.insert(()=>B);if(t.img){let H=p.append("image");H.attr("href",t.img),H.attr("width",n),H.attr("height",c),H.attr("preserveAspectRatio","none"),H.attr("transform",`translate(${-n/2},${g?A/2-c:-A/2})`)}return m.attr("transform",`translate(${-f.width/2-(f.x-(f.left??0))},${g?-c/2-f.height/2-y/2:c/2-f.height/2+y/2})`),E.attr("transform",`translate(0,${g?f.height/2+y/2:-f.height/2-y/2})`),v(t,W),t.intersect=function(H){if(R.info("iconSquare intersect",t,H),!t.label)return S.rect(t,H);let _=t.x??0,F=t.y??0,G=t.height??0,O=[];return g?O=[{x:_-f.width/2,y:F-G/2},{x:_+f.width/2,y:F-G/2},{x:_+f.width/2,y:F-G/2+f.height+y},{x:_+n/2,y:F-G/2+f.height+y},{x:_+n/2,y:F+G/2},{x:_-n/2,y:F+G/2},{x:_-n/2,y:F-G/2+f.height+y},{x:_-f.width/2,y:F-G/2+f.height+y}]:O=[{x:_-n/2,y:F-G/2},{x:_+n/2,y:F-G/2},{x:_+n/2,y:F-G/2+c},{x:_+f.width/2,y:F-G/2+c},{x:_+f.width/2/2,y:F+G/2},{x:_-f.width/2,y:F+G/2},{x:_-f.width/2,y:F-G/2+c},{x:_-n/2,y:F-G/2+c}],S.polygon(t,O,H)},p},"imageSquare");var Hr=u(async(i,t,{config:{themeVariables:s,flowchart:a}})=>{let{labelStyles:r}=$(t);t.labelStyle=r;let o=t.assetHeight??48,h=t.assetWidth??48,e=Math.max(o,h),l=a?.wrappingWidth;t.width=Math.max(e,l??0);let{shapeSvg:n,bbox:c,halfPadding:p,label:f}=await C(i,t,"icon-shape default"),m=t.pos==="t",g=e+p*2,d=e+p*2,{nodeBorder:x,mainBkg:y}=s,{stylesMap:b}=st(t),w=-d/2,P=-g/2,M=t.label?8:0,A=k.svg(n),B=N(t,{stroke:b.get("fill")||y});t.look!=="handDrawn"&&(B.roughness=0,B.fillStyle="solid");let E=A.path(et(w,P,d,g,5),B),W=Math.max(d,c.width),H=g+c.height+M,_=A.rectangle(-W/2,-H/2,W,H,{...B,fill:"transparent",stroke:"none"}),F=n.insert(()=>E,":first-child"),G=n.insert(()=>_);if(t.icon){let O=n.append("g");O.html(`<g>${await ot(t.icon,{height:e,width:e,fallbackPrefix:""})}</g>`);let L=O.node().getBBox(),j=L.width,T=L.height,U=L.x,at=L.y;O.attr("transform",`translate(${-j/2-U},${m?c.height/2+M/2-T/2-at:-c.height/2-M/2-T/2-at})`),O.selectAll("path").attr("fill",b.get("stroke")??x)}return f.attr("transform",`translate(${-c.width/2-(c.x-(c.left??0))},${m?-H/2:H/2-c.height})`),F.attr("transform",`translate(0,${m?c.height/2+M/2:-c.height/2-M/2})`),v(t,G),t.intersect=function(O){if(R.info("iconSquare intersect",t,O),!t.label)return S.rect(t,O);let L=t.x??0,j=t.y??0,T=t.height??0,U=[];return m?U=[{x:L-c.width/2,y:j-T/2},{x:L+c.width/2,y:j-T/2},{x:L+c.width/2,y:j-T/2+c.height+M},{x:L+d/2,y:j-T/2+c.height+M},{x:L+d/2,y:j+T/2},{x:L-d/2,y:j+T/2},{x:L-d/2,y:j-T/2+c.height+M},{x:L-c.width/2,y:j-T/2+c.height+M}]:U=[{x:L-d/2,y:j-T/2},{x:L+d/2,y:j-T/2},{x:L+d/2,y:j-T/2+g},{x:L+c.width/2,y:j-T/2+g},{x:L+c.width/2/2,y:j+T/2},{x:L-c.width/2,y:j+T/2},{x:L-c.width/2,y:j-T/2+g},{x:L-d/2,y:j-T/2+g}],S.polygon(t,U,O)},n},"iconRounded");var Ie={state:Mr,stateStart:$t,stateEnd:Pt,forkJoin:Kt,choice:Nr,note:vr,rectWithTitle:$r,roundedRect:Jt,squareRect:dt,rectangle:dt,rect:dt,process:dt,proc:dt,rounded:Jt,event:Jt,stadium:te,pill:te,terminal:te,subroutine:yt,"framed-rectangle":yt,"fr-rect":yt,subprocess:yt,subproc:yt,cylinder:Ct,db:Ct,cyl:Ct,database:Ct,question:Dt,diam:Dt,diamond:Dt,decision:Dt,hexagon:re,hex:re,prepare:re,lean_right:Lt,"lean-r":Lt,"lean-right":Lt,"in-out":Lt,lean_left:At,"lean-l":At,"lean-left":At,"out-in":At,trapezoid:Rt,"trap-b":Rt,"trapezoid-bottom":Rt,priority:Rt,inv_trapezoid:bt,"inv-trapezoid":bt,"trapezoid-top":bt,"trap-t":bt,manual:bt,doublecircle:ee,"dbl-circ":ee,"double-circle":ee,circle:Ee,circ:Ee,rect_left_inv_arrow:Oe,odd:Oe,card:se,"notched-rectangle":se,"notch-rect":se,"lined-rectangle":xt,"lin-rect":xt,"lin-proc":xt,"lined-process":xt,"shaded-process":xt,"small-circle":$t,"sm-circ":$t,start:$t,stop:Pt,"framed-circle":Pt,"fr-circ":Pt,join:Kt,fork:Kt,comment:de,"brace-l":de,bolt:me,"com-link":me,"lightning-bolt":me,doc:We,document:We,delay:Ge,"half-rounded-rectangle":Ge,"horizontal-cylinder":ce,"h-cyl":ce,das:ce,"lined-cylinder":fe,"lin-cyl":fe,disk:fe,"curved-trapezoid":oe,"curv-trap":oe,display:oe,"divided-rectangle":Bt,"div-rect":Bt,"div-proc":Bt,"divided-process":Bt,triangle:ae,tri:ae,extract:ae,"window-pane":ue,"win-pane":ue,"internal-storage":ue,"f-circ":ge,junction:ge,"filled-circle":ge,"lin-doc":Te,"lined-document":Te,"notched-pentagon":he,"notch-pent":he,"loop-limit":he,"flipped-triangle":pe,"flip-tri":pe,"manual-file":pe,"sloped-rectangle":ne,"sl-rect":ne,"manual-input":ne,docs:Gt,documents:Gt,"st-doc":Gt,"stacked-document":Gt,processes:Ot,procs:Ot,"stacked-rectangle":Ot,"st-rect":Ot,flag:He,"paper-tape":He,"bow-tie-rectangle":ie,"bow-rect":ie,"stored-data":ie,"crossed-circle":le,"cross-circ":le,summary:le,"tag-doc":je,"tagged-document":je,"tag-rect":Et,"tagged-rectangle":Et,"tag-proc":Et,"tagged-process":Et,hourglass:Ve,collate:Ve,text:Pr,anchor:Cr,brace:de,labelRect:Dr,"brace-r":Ar,braces:Rr,iconSquare:Br,iconCircle:Er,icon:Or,iconRounded:Hr,imageSquare:Gr},wt=new Map,pm=u(async(i,t,s)=>{let a,r;if(t.shape==="rect"&&(t.rx&&t.ry?t.shape="roundedRect":t.shape="squareRect"),!Ie[t.shape])throw new Error(`No such shape: ${t.shape}. Please check your syntax.`);if(t.link){let o;s.config.securityLevel==="sandbox"?o="_top":t.linkTarget&&(o=t.linkTarget||"_blank"),a=i.insert("svg:a").attr("xlink:href",t.link).attr("target",o),r=await Ie[t.shape](a,t,s)}else r=await Ie[t.shape](i,t,s),a=r;return t.tooltip&&r.attr("title",t.tooltip),wt.set(t.id,a),t.haveCallback&&wt.get(t.id).attr("class",wt.get(t.id).attr("class")+" clickable"),a},"insertNode"),fm=u((i,t)=>{wt.set(t.id,i)},"setNodeElem"),mm=u(()=>{wt.clear()},"clear"),gm=u(i=>{let t=wt.get(i.id);R.trace("Transforming node",i.diff,i,"translate("+(i.x-i.width/2-5)+", "+i.width/2+")");let s=8,a=i.diff||0;return i.clusterNode?t.attr("transform","translate("+(i.x+a-i.width/2)+", "+(i.y-i.height/2-s)+")"):t.attr("transform","translate("+i.x+", "+i.y+")"),a},"positionNode");export{la as a,ca as b,$a as c,Pa as d,Ca as e,Da as f,Ba as g,C as h,v as i,pm as j,fm as k,mm as l,gm as m};
